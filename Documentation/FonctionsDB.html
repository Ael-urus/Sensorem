<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>FonctionsDB API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;
                Module Index
            </a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#DBManager">DBManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DBManager.__init__">DBManager</a>
                        </li>
                        <li>
                                <a class="variable" href="#DBManager.db_path">db_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#DBManager.conn">conn</a>
                        </li>
                        <li>
                                <a class="variable" href="#DBManager.cursor">cursor</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.connect">connect</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.disconnect">disconnect</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.execute_query">execute_query</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.ajouter_calibration">ajouter_calibration</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.get_calibrations">get_calibrations</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.supprimer_calibration">supprimer_calibration</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.exporter_excel">exporter_excel</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.get_dernieres_calibrations">get_dernieres_calibrations</a>
                        </li>
                        <li>
                                <a class="function" href="#DBManager.exporter_dernieres_calibrations">exporter_dernieres_calibrations</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#GestionnaireFenetreDB">GestionnaireFenetreDB</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#GestionnaireFenetreDB.fenetre_db">fenetre_db</a>
                        </li>
                        <li>
                                <a class="function" href="#GestionnaireFenetreDB.ouvrir_fenetre_db">ouvrir_fenetre_db</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#creer_onglet_base_de_donnees">creer_onglet_base_de_donnees</a>
            </li>
            <li>
                    <a class="function" href="#creer_onglet_deux">creer_onglet_deux</a>
            </li>
            <li>
                    <a class="function" href="#creer_treeview_calibrations">creer_treeview_calibrations</a>
            </li>
            <li>
                    <a class="function" href="#creer_treeview_paliers">creer_treeview_paliers</a>
            </li>
            <li>
                    <a class="function" href="#exporter_donnees_filtrees">exporter_donnees_filtrees</a>
            </li>
            <li>
                    <a class="function" href="#exporter_dernieres_calibrations_db">exporter_dernieres_calibrations_db</a>
            </li>
            <li>
                    <a class="function" href="#Nan">Nan</a>
            </li>
            <li>
                    <a class="function" href="#creer_affichage">creer_affichage</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
FonctionsDB    </h1>

                
                        <input id="mod-FonctionsDB-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-FonctionsDB-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1">#FonctionsDB.py</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span><span class="p">,</span> <span class="n">messagebox</span><span class="p">,</span> <span class="n">font</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">sqlite3</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">FonctionsSignal</span> <span class="k">as</span> <span class="nn">fs</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">DBManager</span><span class="p">:</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">    Gestionnaire de base de données pour les capteurs.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    Cette classe permet de gérer les données de calibration des capteurs dans une base de données SQLite.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    Elle fournit des méthodes pour ajouter, supprimer, récupérer et exporter les données de calibration.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_path</span><span class="o">=</span><span class="s1">&#39;capteurs.db&#39;</span><span class="p">):</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">        Initialisation du gestionnaire de base de données.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">        :param db_path: Chemin de la base de données SQLite (par défaut : &#39;capteurs.db&#39;).</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        Établit la connexion à la base de données.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        :return: True si la connexion réussit, False sinon.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>            <span class="c1"># Établir la connexion à la base de données</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>            <span class="c1"># Créer un curseur pour exécuter les requêtes</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>            <span class="c1"># Gérer les erreurs de connexion</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur de connexion : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        Ferme la connexion à la base de données.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="c1"># Fermer la connexion si elle est établie</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        Exécute une requête SQL avec gestion des erreurs et commit.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        :param query: La requête SQL à exécuter.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        :param params: Les paramètres à passer à la requête (optionnel).</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">                 et le résultat de la requête (None si pas de résultat).</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>            <span class="c1"># Exécuter la requête avec les paramètres</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>            <span class="c1"># Valider les modifications</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>            <span class="c1"># Récupérer le résultat de la requête si elle est une requête de sélection</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;SELECT&quot;</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="c1"># Gérer les erreurs de requête</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">ajouter_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date_test</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">numcapteur</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fichier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>                            <span class="n">coef_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">datat1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">datat2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        Ajoute une calibration avec les paliers associés.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        :param date_test: Date du test.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        :param numcapteur: Numéro du capteur.</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        :param nom_utilisateur: Nom de l&#39;utilisateur.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        :param fichier: Nom du fichier source.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        :param coef_a: Coefficient de conversion a.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        :param coef_b: Coefficient de conversion b.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">        :param a_reg: Coefficient capteur a.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        :param b_reg: Coefficient capteur b.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        :param datat1: Liste des données t1 pour les paliers.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        :param datat2: Liste des données t2 pour les paliers.</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;ajout</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="c1"># Insertion de la calibration</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="s2">                INSERT INTO calibrations (</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="s2">                    date_test, version_logiciel, nom_capteur, operateur,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="s2">                    fichier_source, coef_conversion_a, coef_conversion_b,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="s2">                    coef_capteur_a, coef_capteur_b</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="s2">                ) VALUES (?,?,?,?,?,?,?,?,?)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">date_test</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">version</span><span class="p">(),</span> <span class="n">numcapteur</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                      <span class="n">fichier</span><span class="p">,</span> <span class="n">coef_a</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de l&#39;insertion de la calibration&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="n">calibration_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">lastrowid</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>            <span class="c1"># Insertion des paliers</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datat1</span><span class="p">)):</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ajouter_palier</span><span class="p">(</span><span class="n">calibration_id</span><span class="p">,</span> <span class="n">datat1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">datat2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;insertion du palier </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration ajoutée avec succès&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">_ajouter_palier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data_t1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">data_t2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        Méthode privée pour ajouter un palier.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        :param calibration_id: ID de la calibration.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        :param data_t1: Données t1 du palier.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        :param data_t2: Données t2 du palier.</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        :return: Un booléen indiquant le succès de l&#39;ajout.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="c1"># Récupérer les informations du palier</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="n">num_palier</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_t1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="n">nb_valeurs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_t1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="s2">                INSERT INTO paliers (</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="s2">                    calibration_id, numero_palier, type, nb_valeurs,</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="s2">                    moyenne_c_rac, ecart_type_c_rac, moyenne_c_ref, ecart_type_c_ref</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="s2">                ) VALUES (?,?,?,?,?,?,?,?)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>                <span class="n">calibration_id</span><span class="p">,</span> <span class="n">num_palier</span><span class="p">,</span> <span class="s2">&quot;asc/desc&quot;</span><span class="p">,</span> <span class="n">nb_valeurs</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>                <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="k">return</span> <span class="n">success</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">get_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sort_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        Récupère les calibrations avec filtres et tri.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        :param filters: Un dictionnaire de filtres (optionnel).</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        :param sort_by: Le critère de tri (optionnel).</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        :return: Une liste de calibrations.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM calibrations&quot;</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="n">filters</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>                    <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> =?&quot;</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="k">if</span> <span class="n">conditions</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>                <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">+</span> <span class="s2">&quot; AND &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="n">sort_by</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; ORDER BY </span><span class="si">{</span><span class="n">sort_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span> <span class="k">if</span> <span class="n">params</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">result</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">supprimer_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        Supprime une calibration et ses paliers associés.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        :param calibration_id: L&#39;ID de la calibration à supprimer.</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la suppression</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="c1"># Supprimer d&#39;abord les paliers (contrainte de clé étrangère)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="s2">                DELETE FROM paliers </span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="s2">                WHERE calibration_id =?</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="c1"># Puis supprimer la calibration</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="s2">                DELETE FROM calibrations </span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="s2">                WHERE id =?</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration supprimée avec succès&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de la suppression : </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">exporter_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filtres</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        Exporte les données avec filtres vers Excel.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        :param filtres: Dictionnaire des filtres à appliquer (optionnel).</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="n">ws_calibrations</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Calibrations&quot;</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="c1"># En-têtes</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="n">calibrations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">(</span><span class="n">filtres</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                    <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                    <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                <span class="p">]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                <span class="c1"># Données</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="c1"># Formatage</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                    <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>                    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>                        <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_length</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="c1"># Nom de fichier avec date</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="n">date_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;export_capteurs_</span><span class="si">{</span><span class="n">date_str</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Export réussi: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>    <span class="k">def</span> <span class="nf">get_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        Récupère la dernière calibration pour chaque capteur.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">                 et soit la liste des calibrations, soit un message d&#39;erreur.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="s2">            WITH DernieresCalibs AS (</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="s2">                SELECT </span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="s2">                    c.*,</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="s2">                    ROW_NUMBER() OVER (</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="s2">                        PARTITION BY nom_capteur </span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="s2">                        ORDER BY date_test DESC, id DESC</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="s2">                    ) as rn</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="s2">                FROM calibrations c</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="s2">            )</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="s2">            SELECT * FROM DernieresCalibs</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="s2">            WHERE rn = 1</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="s2">            ORDER BY nom_capteur</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de la récupération des dernières calibrations&quot;</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Aucune calibration trouvée&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>    <span class="k">def</span> <span class="nf">get_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        Récupère la dernière calibration pour chaque capteur.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">                 et soit la liste des calibrations, soit un message d&#39;erreur.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="s2">            WITH DernieresCalibs AS (</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="s2">                SELECT </span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="s2">                    c.*,</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="s2">                    ROW_NUMBER() OVER (</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="s2">                        PARTITION BY nom_capteur </span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="s2">                        ORDER BY date_test DESC, id DESC</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="s2">                    ) as rn</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="s2">                FROM calibrations c</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="s2">            )</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="s2">            SELECT * FROM DernieresCalibs</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="s2">            WHERE rn = 1</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="s2">            ORDER BY nom_capteur</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">exporter_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        Exporte les dernières calibrations pour chaque capteur dans un fichier Excel.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dernieres_calibrations</span><span class="p">()</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de la récupération des dernières calibrations&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Dernières Calibrations&quot;</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>            <span class="c1"># Ajouter les en-têtes</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                       <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span><span class="p">]</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="c1"># Ajouter les données</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>                <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="c1"># Sauvegarde du fichier avec un horodatage unique</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dernieres_calibrations_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Les dernières calibrations ont été exportées dans </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="k">class</span> <span class="nc">GestionnaireFenetreDB</span><span class="p">:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>    <span class="k">def</span> <span class="nf">ouvrir_fenetre_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ouvre la fenêtre de gestion de base de données si elle n&#39;existe pas déjà.&quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">winfo_exists</span><span class="p">():</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="c1"># Créer une nouvelle fenêtre</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gestion de la Base de Données&quot;</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="c1"># Définir les dimensions</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="n">window_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="n">window_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">window_width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">window_height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="c1"># Créer le notebook et les onglets</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">notebook</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>            <span class="n">notebook</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="c1"># Créer les onglets avec les fonctions existantes</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="n">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="n">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="c1"># Assurer que la fenêtre reste au premier plan jusqu&#39;à sa fermeture</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="c1"># Gérer la fermeture propre</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="k">def</span> <span class="nf">on_closing</span><span class="p">():</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_release</span><span class="p">()</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="n">on_closing</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="c1"># Si la fenêtre existe déjà, la mettre au premier plan</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">focus_force</span><span class="p">()</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="k">def</span> <span class="nf">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">):</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée l&#39;onglet Base de données avec filtres et tri.&quot;&quot;&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Base de données&quot;</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>    <span class="c1"># Frame pour les filtres</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>    <span class="n">frame_filtres</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filtres&quot;</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>    <span class="n">frame_filtres</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>    <span class="c1"># Frame pour les TreeViews</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>    <span class="n">frame_data</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>    <span class="n">frame_data</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>    <span class="c1"># Création du PanedWindow pour les TreeViews</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>    <span class="n">paned</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">PanedWindow</span><span class="p">(</span><span class="n">frame_data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>    <span class="c1"># Création des TreeViews</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>    <span class="n">tree_calibrations</span> <span class="o">=</span> <span class="n">creer_treeview_calibrations</span><span class="p">(</span><span class="n">paned</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>    <span class="n">tree_paliers</span> <span class="o">=</span> <span class="n">creer_treeview_paliers</span><span class="p">(</span><span class="n">paned</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree_calibrations</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree_paliers</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>    <span class="c1"># Variables pour les filtres</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>    <span class="n">filtres</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="s1">&#39;capteur&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(),</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="s1">&#39;annee&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(),</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="s1">&#39;operateur&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>    <span class="p">}</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>    <span class="c1"># Création des widgets de filtres</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Capteur:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Année:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Opérateur:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>    <span class="k">def</span> <span class="nf">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">calibrations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Met à jour l&#39;affichage des TreeViews avec les données filtrées.&quot;&quot;&quot;</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="c1"># Effacer les données existantes</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="c1"># Si aucune donnée n&#39;est fournie, récupérer toutes les calibrations</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="k">if</span> <span class="n">calibrations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">calibrations</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">()</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="c1"># Insérer les nouvelles données</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">cal</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>    <span class="k">def</span> <span class="nf">appliquer_filtres</span><span class="p">():</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applique les filtres sélectionnés.&quot;&quot;&quot;</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;nom_capteur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;strftime(&quot;%Y&quot;, date_test)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>        <span class="n">calibrations</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>        <span class="n">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">calibrations</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>    <span class="k">def</span> <span class="nf">on_calibration_select</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gère la sélection d&#39;une ou plusieurs calibrations.&quot;&quot;&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>        <span class="c1"># Effacer les paliers existants</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Si une seule calibration est sélectionnée</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="n">item</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="n">calibration_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="c1"># Charger les paliers pour cette calibration</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">paliers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                <span class="s2">&quot;SELECT * FROM paliers WHERE calibration_id = ? ORDER BY numero_palier&quot;</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>                <span class="p">(</span><span class="n">calibration_id</span><span class="p">,)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                <span class="k">for</span> <span class="n">palier</span> <span class="ow">in</span> <span class="n">paliers</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                    <span class="n">tree_paliers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">palier</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>    <span class="k">def</span> <span class="nf">afficher_dernieres_calibrations</span><span class="p">():</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Affiche uniquement la dernière calibration de chaque capteur.&quot;&quot;&quot;</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_dernieres_calibrations</span><span class="p">()</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="n">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="s2">&quot;Impossible de récupérer les dernières calibrations&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>    <span class="c1"># Liaison des événements</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>    <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;TreeviewSelect&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">on_calibration_select</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>    <span class="c1"># Boutons d&#39;action</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>    <span class="n">frame_boutons</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>    <span class="n">frame_boutons</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">supprimer_calibrations_selectionnees</span><span class="p">():</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Supprime toutes les calibrations sélectionnées après confirmation.&quot;&quot;&quot;</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">selection</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Avertissement&quot;</span><span class="p">,</span> <span class="s2">&quot;Veuillez sélectionner au moins une calibration à supprimer.&quot;</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>            <span class="k">return</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="n">nb_selections</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askyesno</span><span class="p">(</span><span class="s2">&quot;Confirmation&quot;</span><span class="p">,</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Êtes-vous sûr de vouloir supprimer ces </span><span class="si">{</span><span class="n">nb_selections</span><span class="si">}</span><span class="s2"> calibration(s) et tous leurs paliers associés ?&quot;</span><span class="p">):</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>            <span class="k">return</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="c1">#db.afficher_liste_capteurs_uniques(notebook)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>        <span class="n">erreurs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>        <span class="n">supprimees</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="k">for</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>            <span class="n">item</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>                <span class="n">calibration_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>                <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">supprimer_calibration</span><span class="p">(</span><span class="n">calibration_id</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>                <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>                    <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>                    <span class="n">supprimees</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                    <span class="n">erreurs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calibration </span><span class="si">{</span><span class="n">calibration_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>                <span class="n">erreurs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur avec l&#39;item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="c1"># Effacer les paliers affichés</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="c1"># Afficher le résultat</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="n">supprimees</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">supprimees</span><span class="si">}</span><span class="s2"> calibration(s) supprimée(s) avec succès.&quot;</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="k">if</span> <span class="n">erreurs</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Erreurs rencontrées :</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">erreurs</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>            <span class="k">if</span> <span class="n">erreurs</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Résultat&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Succès&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="s2">&quot;Aucune suppression effectuée.</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">erreurs</span><span class="p">))</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>    <span class="c1"># Ajouter le bouton de suppression</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Supprimer sélection&quot;</span><span class="p">,</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">supprimer_calibrations_selectionnees</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Appliquer filtres&quot;</span><span class="p">,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">appliquer_filtres</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Réinitialiser filtres&quot;</span><span class="p">,</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">filtres</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="n">mettre_a_jour_affichage</span><span class="p">()])</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exporter filtrés ou liste complete&quot;</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">exporter_donnees_filtrees</span><span class="p">(</span><span class="n">filtres</span><span class="p">))</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>    <span class="c1"># Ajout du bouton afficher_dernieres_calibrations dans l&#39;interface</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dernières calibrations&quot;</span><span class="p">,</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">afficher_dernieres_calibrations</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>    <span class="c1"># Ajout du bouton exporter_dernieres_calibrations dans l&#39;interface</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exporter dernières calibrations&quot;</span><span class="p">,</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">exporter_dernieres_calibrations_db</span><span class="p">()</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>    <span class="c1"># Chargement initial des données</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="n">mettre_a_jour_affichage</span><span class="p">()</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>    <span class="k">return</span> <span class="n">frame</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="k">def</span> <span class="nf">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">):</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée le 2e onglet  dans le notebook.&quot;&quot;&quot;</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;EnCours&quot;</span><span class="p">)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>    <span class="c1"># Ajout de contenu dans frame_2 (exemple)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>    <span class="n">label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Contenu de l&#39;onglet &#39;EnCours&#39; options pour plus tard&quot;</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>    <span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>    <span class="n">bouton</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cliquez-moi&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">Nan</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>    <span class="n">bouton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="k">def</span> <span class="nf">creer_treeview_calibrations</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée et configure le TreeView des calibrations avec sélection multiple.&quot;&quot;&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>    <span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;date_test&quot;</span><span class="p">,</span> <span class="s2">&quot;version_logiciel&quot;</span><span class="p">,</span> <span class="s2">&quot;nom_capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;operateur&quot;</span><span class="p">,</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>               <span class="s2">&quot;fichier_source&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_conversion_a&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_conversion_b&quot;</span><span class="p">,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>               <span class="s2">&quot;coef_capteur_a&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_capteur_b&quot;</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>    <span class="c1"># Ajouter le paramètre selectmode=&#39;extended&#39; pour permettre la sélection multiple</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s2">&quot;headings&quot;</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="s1">&#39;extended&#39;</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>        <span class="s2">&quot;date_test&quot;</span><span class="p">:</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>        <span class="s2">&quot;version_logiciel&quot;</span><span class="p">:</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>        <span class="s2">&quot;nom_capteur&quot;</span><span class="p">:</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>        <span class="s2">&quot;operateur&quot;</span><span class="p">:</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>        <span class="s2">&quot;fichier_source&quot;</span><span class="p">:</span> <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="s2">&quot;coef_conversion_a&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>        <span class="s2">&quot;coef_conversion_b&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="s2">&quot;coef_capteur_a&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="s2">&quot;coef_capteur_b&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Capt B&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>    <span class="p">}</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>    <span class="c1"># Scrollbars</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>    <span class="n">vsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>    <span class="n">hsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">xview</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">vsb</span><span class="o">.</span><span class="n">set</span><span class="p">,</span> <span class="n">xscrollcommand</span><span class="o">=</span><span class="n">hsb</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>    <span class="n">vsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>    <span class="n">hsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>    <span class="k">return</span> <span class="n">tree</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="k">def</span> <span class="nf">creer_treeview_paliers</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée et configure le TreeView des paliers.&quot;&quot;&quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>    <span class="c1"># Définition des colonnes</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>    <span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;calibration_id&quot;</span><span class="p">,</span> <span class="s2">&quot;numero_palier&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;nb_valeurs&quot;</span><span class="p">,</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>               <span class="s2">&quot;moyenne_c_rac&quot;</span><span class="p">,</span> <span class="s2">&quot;ecart_type_c_rac&quot;</span><span class="p">,</span> <span class="s2">&quot;moyenne_c_ref&quot;</span><span class="p">,</span> <span class="s2">&quot;ecart_type_c_ref&quot;</span><span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s2">&quot;headings&quot;</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>    <span class="c1"># Configuration des en-têtes</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>        <span class="s2">&quot;calibration_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Cal ID&quot;</span><span class="p">,</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="s2">&quot;numero_palier&quot;</span><span class="p">:</span> <span class="s2">&quot;N° Palier&quot;</span><span class="p">,</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="s2">&quot;nb_valeurs&quot;</span><span class="p">:</span> <span class="s2">&quot;Nb Valeurs&quot;</span><span class="p">,</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>        <span class="s2">&quot;moyenne_c_rac&quot;</span><span class="p">:</span> <span class="s2">&quot;Moy C_rac&quot;</span><span class="p">,</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="s2">&quot;ecart_type_c_rac&quot;</span><span class="p">:</span> <span class="s2">&quot;ET C_rac&quot;</span><span class="p">,</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>        <span class="s2">&quot;moyenne_c_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;Moy C_ref&quot;</span><span class="p">,</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>        <span class="s2">&quot;ecart_type_c_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;ET C_ref&quot;</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>    <span class="p">}</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>    <span class="c1"># Scrollbars</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>    <span class="n">vsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>    <span class="n">hsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">xview</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">vsb</span><span class="o">.</span><span class="n">set</span><span class="p">,</span> <span class="n">xscrollcommand</span><span class="o">=</span><span class="n">hsb</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>    <span class="c1"># Placement des widgets</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>    <span class="n">vsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>    <span class="n">hsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>    <span class="c1"># Configuration du redimensionnement</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>  <span class="c1"># Permet d&#39;accéder au frame depuis l&#39;extérieur</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>    <span class="k">return</span> <span class="n">tree</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a><span class="k">def</span> <span class="nf">exporter_donnees_filtrees</span><span class="p">(</span><span class="n">filtres</span><span class="p">):</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exporte les données filtrées vers Excel.&quot;&quot;&quot;</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;nom_capteur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;strftime(&quot;%Y&quot;, date_test)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>    <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">exporter_excel</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Export réussi&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a><span class="k">def</span> <span class="nf">exporter_dernieres_calibrations_db</span><span class="p">():</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Appelle directement la méthode de DBManager pour exporter les dernières calibrations.&quot;&quot;&quot;</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>    <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">exporter_dernieres_calibrations</span><span class="p">()</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Export réussi&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="k">def</span> <span class="nf">Nan</span><span class="p">():</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Le gars il a dit non :p, mais mais mais&quot;</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>    <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a><span class="k">def</span> <span class="nf">creer_affichage</span><span class="p">(</span><span class="n">root</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée l&#39;interface graphique principale et gère la taille de la fenêtre.&quot;&quot;&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span> <span class="c1"># Important pour obtenir les dimensions correctes</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>    <span class="n">screen_width</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>    <span class="n">screen_height</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>    <span class="c1"># Définir une taille maximale pour la fenêtre (par exemple, 80% de l&#39;écran)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>    <span class="n">max_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">screen_width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>    <span class="n">max_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">screen_height</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">max_height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Définir la taille maximale</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>    <span class="n">notebook</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>    <span class="n">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>    <span class="n">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>    <span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>    <span class="n">creer_affichage</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>    <span class="c1"># Appeler ajouter_exemple_donnees APRÈS root.mainloop() avec root.after</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>    <span class="c1">#root.after(100, ajouter_exemple_donnees)  # Délai de 100ms</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>    <span class="c1">#root.after(100, ajouter_exemple_donnees)  # Délai de 100ms</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>    <span class="c1">#root.after(100, ajouter_exemple_donnees)  # Délai de 100ms</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="DBManager">
                            <input id="DBManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DBManager</span>:

                <label class="view-source-button" for="DBManager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager-12"><a href="#DBManager-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">DBManager</span><span class="p">:</span>
</span><span id="DBManager-13"><a href="#DBManager-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-14"><a href="#DBManager-14"><span class="linenos"> 14</span></a><span class="sd">    Gestionnaire de base de données pour les capteurs.</span>
</span><span id="DBManager-15"><a href="#DBManager-15"><span class="linenos"> 15</span></a>
</span><span id="DBManager-16"><a href="#DBManager-16"><span class="linenos"> 16</span></a><span class="sd">    Cette classe permet de gérer les données de calibration des capteurs dans une base de données SQLite.</span>
</span><span id="DBManager-17"><a href="#DBManager-17"><span class="linenos"> 17</span></a><span class="sd">    Elle fournit des méthodes pour ajouter, supprimer, récupérer et exporter les données de calibration.</span>
</span><span id="DBManager-18"><a href="#DBManager-18"><span class="linenos"> 18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DBManager-19"><a href="#DBManager-19"><span class="linenos"> 19</span></a>
</span><span id="DBManager-20"><a href="#DBManager-20"><span class="linenos"> 20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_path</span><span class="o">=</span><span class="s1">&#39;capteurs.db&#39;</span><span class="p">):</span>
</span><span id="DBManager-21"><a href="#DBManager-21"><span class="linenos"> 21</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-22"><a href="#DBManager-22"><span class="linenos"> 22</span></a><span class="sd">        Initialisation du gestionnaire de base de données.</span>
</span><span id="DBManager-23"><a href="#DBManager-23"><span class="linenos"> 23</span></a>
</span><span id="DBManager-24"><a href="#DBManager-24"><span class="linenos"> 24</span></a><span class="sd">        :param db_path: Chemin de la base de données SQLite (par défaut : &#39;capteurs.db&#39;).</span>
</span><span id="DBManager-25"><a href="#DBManager-25"><span class="linenos"> 25</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-26"><a href="#DBManager-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="DBManager-27"><a href="#DBManager-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DBManager-28"><a href="#DBManager-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DBManager-29"><a href="#DBManager-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="DBManager-30"><a href="#DBManager-30"><span class="linenos"> 30</span></a>
</span><span id="DBManager-31"><a href="#DBManager-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DBManager-32"><a href="#DBManager-32"><span class="linenos"> 32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-33"><a href="#DBManager-33"><span class="linenos"> 33</span></a><span class="sd">        Établit la connexion à la base de données.</span>
</span><span id="DBManager-34"><a href="#DBManager-34"><span class="linenos"> 34</span></a>
</span><span id="DBManager-35"><a href="#DBManager-35"><span class="linenos"> 35</span></a><span class="sd">        :return: True si la connexion réussit, False sinon.</span>
</span><span id="DBManager-36"><a href="#DBManager-36"><span class="linenos"> 36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-37"><a href="#DBManager-37"><span class="linenos"> 37</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-38"><a href="#DBManager-38"><span class="linenos"> 38</span></a>            <span class="c1"># Établir la connexion à la base de données</span>
</span><span id="DBManager-39"><a href="#DBManager-39"><span class="linenos"> 39</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="DBManager-40"><a href="#DBManager-40"><span class="linenos"> 40</span></a>            <span class="c1"># Créer un curseur pour exécuter les requêtes</span>
</span><span id="DBManager-41"><a href="#DBManager-41"><span class="linenos"> 41</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="DBManager-42"><a href="#DBManager-42"><span class="linenos"> 42</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DBManager-43"><a href="#DBManager-43"><span class="linenos"> 43</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-44"><a href="#DBManager-44"><span class="linenos"> 44</span></a>            <span class="c1"># Gérer les erreurs de connexion</span>
</span><span id="DBManager-45"><a href="#DBManager-45"><span class="linenos"> 45</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur de connexion : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DBManager-46"><a href="#DBManager-46"><span class="linenos"> 46</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DBManager-47"><a href="#DBManager-47"><span class="linenos"> 47</span></a>
</span><span id="DBManager-48"><a href="#DBManager-48"><span class="linenos"> 48</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DBManager-49"><a href="#DBManager-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-50"><a href="#DBManager-50"><span class="linenos"> 50</span></a><span class="sd">        Ferme la connexion à la base de données.</span>
</span><span id="DBManager-51"><a href="#DBManager-51"><span class="linenos"> 51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-52"><a href="#DBManager-52"><span class="linenos"> 52</span></a>        <span class="c1"># Fermer la connexion si elle est établie</span>
</span><span id="DBManager-53"><a href="#DBManager-53"><span class="linenos"> 53</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
</span><span id="DBManager-54"><a href="#DBManager-54"><span class="linenos"> 54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="DBManager-55"><a href="#DBManager-55"><span class="linenos"> 55</span></a>
</span><span id="DBManager-56"><a href="#DBManager-56"><span class="linenos"> 56</span></a>    <span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DBManager-57"><a href="#DBManager-57"><span class="linenos"> 57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-58"><a href="#DBManager-58"><span class="linenos"> 58</span></a><span class="sd">        Exécute une requête SQL avec gestion des erreurs et commit.</span>
</span><span id="DBManager-59"><a href="#DBManager-59"><span class="linenos"> 59</span></a>
</span><span id="DBManager-60"><a href="#DBManager-60"><span class="linenos"> 60</span></a><span class="sd">        :param query: La requête SQL à exécuter.</span>
</span><span id="DBManager-61"><a href="#DBManager-61"><span class="linenos"> 61</span></a><span class="sd">        :param params: Les paramètres à passer à la requête (optionnel).</span>
</span><span id="DBManager-62"><a href="#DBManager-62"><span class="linenos"> 62</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="DBManager-63"><a href="#DBManager-63"><span class="linenos"> 63</span></a><span class="sd">                 et le résultat de la requête (None si pas de résultat).</span>
</span><span id="DBManager-64"><a href="#DBManager-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-65"><a href="#DBManager-65"><span class="linenos"> 65</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-66"><a href="#DBManager-66"><span class="linenos"> 66</span></a>            <span class="c1"># Exécuter la requête avec les paramètres</span>
</span><span id="DBManager-67"><a href="#DBManager-67"><span class="linenos"> 67</span></a>            <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
</span><span id="DBManager-68"><a href="#DBManager-68"><span class="linenos"> 68</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="DBManager-69"><a href="#DBManager-69"><span class="linenos"> 69</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DBManager-70"><a href="#DBManager-70"><span class="linenos"> 70</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="DBManager-71"><a href="#DBManager-71"><span class="linenos"> 71</span></a>            <span class="c1"># Valider les modifications</span>
</span><span id="DBManager-72"><a href="#DBManager-72"><span class="linenos"> 72</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="DBManager-73"><a href="#DBManager-73"><span class="linenos"> 73</span></a>            <span class="c1"># Récupérer le résultat de la requête si elle est une requête de sélection</span>
</span><span id="DBManager-74"><a href="#DBManager-74"><span class="linenos"> 74</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;SELECT&quot;</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="DBManager-75"><a href="#DBManager-75"><span class="linenos"> 75</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span>
</span><span id="DBManager-76"><a href="#DBManager-76"><span class="linenos"> 76</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-77"><a href="#DBManager-77"><span class="linenos"> 77</span></a>            <span class="c1"># Gérer les erreurs de requête</span>
</span><span id="DBManager-78"><a href="#DBManager-78"><span class="linenos"> 78</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="DBManager-79"><a href="#DBManager-79"><span class="linenos"> 79</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="DBManager-80"><a href="#DBManager-80"><span class="linenos"> 80</span></a>
</span><span id="DBManager-81"><a href="#DBManager-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="nf">ajouter_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date_test</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">numcapteur</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fichier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DBManager-82"><a href="#DBManager-82"><span class="linenos"> 82</span></a>                            <span class="n">coef_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">datat1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">datat2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-83"><a href="#DBManager-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-84"><a href="#DBManager-84"><span class="linenos"> 84</span></a><span class="sd">        Ajoute une calibration avec les paliers associés.</span>
</span><span id="DBManager-85"><a href="#DBManager-85"><span class="linenos"> 85</span></a>
</span><span id="DBManager-86"><a href="#DBManager-86"><span class="linenos"> 86</span></a><span class="sd">        :param date_test: Date du test.</span>
</span><span id="DBManager-87"><a href="#DBManager-87"><span class="linenos"> 87</span></a><span class="sd">        :param numcapteur: Numéro du capteur.</span>
</span><span id="DBManager-88"><a href="#DBManager-88"><span class="linenos"> 88</span></a><span class="sd">        :param nom_utilisateur: Nom de l&#39;utilisateur.</span>
</span><span id="DBManager-89"><a href="#DBManager-89"><span class="linenos"> 89</span></a><span class="sd">        :param fichier: Nom du fichier source.</span>
</span><span id="DBManager-90"><a href="#DBManager-90"><span class="linenos"> 90</span></a><span class="sd">        :param coef_a: Coefficient de conversion a.</span>
</span><span id="DBManager-91"><a href="#DBManager-91"><span class="linenos"> 91</span></a><span class="sd">        :param coef_b: Coefficient de conversion b.</span>
</span><span id="DBManager-92"><a href="#DBManager-92"><span class="linenos"> 92</span></a><span class="sd">        :param a_reg: Coefficient capteur a.</span>
</span><span id="DBManager-93"><a href="#DBManager-93"><span class="linenos"> 93</span></a><span class="sd">        :param b_reg: Coefficient capteur b.</span>
</span><span id="DBManager-94"><a href="#DBManager-94"><span class="linenos"> 94</span></a><span class="sd">        :param datat1: Liste des données t1 pour les paliers.</span>
</span><span id="DBManager-95"><a href="#DBManager-95"><span class="linenos"> 95</span></a><span class="sd">        :param datat2: Liste des données t2 pour les paliers.</span>
</span><span id="DBManager-96"><a href="#DBManager-96"><span class="linenos"> 96</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;ajout</span>
</span><span id="DBManager-97"><a href="#DBManager-97"><span class="linenos"> 97</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager-98"><a href="#DBManager-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-99"><a href="#DBManager-99"><span class="linenos"> 99</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-100"><a href="#DBManager-100"><span class="linenos">100</span></a>            <span class="c1"># Insertion de la calibration</span>
</span><span id="DBManager-101"><a href="#DBManager-101"><span class="linenos">101</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-102"><a href="#DBManager-102"><span class="linenos">102</span></a><span class="s2">                INSERT INTO calibrations (</span>
</span><span id="DBManager-103"><a href="#DBManager-103"><span class="linenos">103</span></a><span class="s2">                    date_test, version_logiciel, nom_capteur, operateur,</span>
</span><span id="DBManager-104"><a href="#DBManager-104"><span class="linenos">104</span></a><span class="s2">                    fichier_source, coef_conversion_a, coef_conversion_b,</span>
</span><span id="DBManager-105"><a href="#DBManager-105"><span class="linenos">105</span></a><span class="s2">                    coef_capteur_a, coef_capteur_b</span>
</span><span id="DBManager-106"><a href="#DBManager-106"><span class="linenos">106</span></a><span class="s2">                ) VALUES (?,?,?,?,?,?,?,?,?)</span>
</span><span id="DBManager-107"><a href="#DBManager-107"><span class="linenos">107</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="DBManager-108"><a href="#DBManager-108"><span class="linenos">108</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">date_test</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">version</span><span class="p">(),</span> <span class="n">numcapteur</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">,</span>
</span><span id="DBManager-109"><a href="#DBManager-109"><span class="linenos">109</span></a>                      <span class="n">fichier</span><span class="p">,</span> <span class="n">coef_a</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">)</span>
</span><span id="DBManager-110"><a href="#DBManager-110"><span class="linenos">110</span></a>
</span><span id="DBManager-111"><a href="#DBManager-111"><span class="linenos">111</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="DBManager-112"><a href="#DBManager-112"><span class="linenos">112</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager-113"><a href="#DBManager-113"><span class="linenos">113</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de l&#39;insertion de la calibration&quot;</span>
</span><span id="DBManager-114"><a href="#DBManager-114"><span class="linenos">114</span></a>
</span><span id="DBManager-115"><a href="#DBManager-115"><span class="linenos">115</span></a>            <span class="n">calibration_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">lastrowid</span>
</span><span id="DBManager-116"><a href="#DBManager-116"><span class="linenos">116</span></a>
</span><span id="DBManager-117"><a href="#DBManager-117"><span class="linenos">117</span></a>            <span class="c1"># Insertion des paliers</span>
</span><span id="DBManager-118"><a href="#DBManager-118"><span class="linenos">118</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datat1</span><span class="p">)):</span>
</span><span id="DBManager-119"><a href="#DBManager-119"><span class="linenos">119</span></a>                <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ajouter_palier</span><span class="p">(</span><span class="n">calibration_id</span><span class="p">,</span> <span class="n">datat1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">datat2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DBManager-120"><a href="#DBManager-120"><span class="linenos">120</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager-121"><a href="#DBManager-121"><span class="linenos">121</span></a>                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;insertion du palier </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-122"><a href="#DBManager-122"><span class="linenos">122</span></a>
</span><span id="DBManager-123"><a href="#DBManager-123"><span class="linenos">123</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration ajoutée avec succès&quot;</span>
</span><span id="DBManager-124"><a href="#DBManager-124"><span class="linenos">124</span></a>
</span><span id="DBManager-125"><a href="#DBManager-125"><span class="linenos">125</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-126"><a href="#DBManager-126"><span class="linenos">126</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="DBManager-127"><a href="#DBManager-127"><span class="linenos">127</span></a>
</span><span id="DBManager-128"><a href="#DBManager-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">_ajouter_palier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data_t1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">data_t2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="DBManager-129"><a href="#DBManager-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-130"><a href="#DBManager-130"><span class="linenos">130</span></a><span class="sd">        Méthode privée pour ajouter un palier.</span>
</span><span id="DBManager-131"><a href="#DBManager-131"><span class="linenos">131</span></a>
</span><span id="DBManager-132"><a href="#DBManager-132"><span class="linenos">132</span></a><span class="sd">        :param calibration_id: ID de la calibration.</span>
</span><span id="DBManager-133"><a href="#DBManager-133"><span class="linenos">133</span></a><span class="sd">        :param data_t1: Données t1 du palier.</span>
</span><span id="DBManager-134"><a href="#DBManager-134"><span class="linenos">134</span></a><span class="sd">        :param data_t2: Données t2 du palier.</span>
</span><span id="DBManager-135"><a href="#DBManager-135"><span class="linenos">135</span></a><span class="sd">        :return: Un booléen indiquant le succès de l&#39;ajout.</span>
</span><span id="DBManager-136"><a href="#DBManager-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-137"><a href="#DBManager-137"><span class="linenos">137</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-138"><a href="#DBManager-138"><span class="linenos">138</span></a>            <span class="c1"># Récupérer les informations du palier</span>
</span><span id="DBManager-139"><a href="#DBManager-139"><span class="linenos">139</span></a>            <span class="n">num_palier</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_t1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DBManager-140"><a href="#DBManager-140"><span class="linenos">140</span></a>            <span class="n">nb_valeurs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_t1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="DBManager-141"><a href="#DBManager-141"><span class="linenos">141</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-142"><a href="#DBManager-142"><span class="linenos">142</span></a><span class="s2">                INSERT INTO paliers (</span>
</span><span id="DBManager-143"><a href="#DBManager-143"><span class="linenos">143</span></a><span class="s2">                    calibration_id, numero_palier, type, nb_valeurs,</span>
</span><span id="DBManager-144"><a href="#DBManager-144"><span class="linenos">144</span></a><span class="s2">                    moyenne_c_rac, ecart_type_c_rac, moyenne_c_ref, ecart_type_c_ref</span>
</span><span id="DBManager-145"><a href="#DBManager-145"><span class="linenos">145</span></a><span class="s2">                ) VALUES (?,?,?,?,?,?,?,?)</span>
</span><span id="DBManager-146"><a href="#DBManager-146"><span class="linenos">146</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="DBManager-147"><a href="#DBManager-147"><span class="linenos">147</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DBManager-148"><a href="#DBManager-148"><span class="linenos">148</span></a>                <span class="n">calibration_id</span><span class="p">,</span> <span class="n">num_palier</span><span class="p">,</span> <span class="s2">&quot;asc/desc&quot;</span><span class="p">,</span> <span class="n">nb_valeurs</span><span class="p">,</span>
</span><span id="DBManager-149"><a href="#DBManager-149"><span class="linenos">149</span></a>                <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="DBManager-150"><a href="#DBManager-150"><span class="linenos">150</span></a>                <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_t2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="DBManager-151"><a href="#DBManager-151"><span class="linenos">151</span></a>            <span class="p">)</span>
</span><span id="DBManager-152"><a href="#DBManager-152"><span class="linenos">152</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="DBManager-153"><a href="#DBManager-153"><span class="linenos">153</span></a>            <span class="k">return</span> <span class="n">success</span>
</span><span id="DBManager-154"><a href="#DBManager-154"><span class="linenos">154</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
</span><span id="DBManager-155"><a href="#DBManager-155"><span class="linenos">155</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DBManager-156"><a href="#DBManager-156"><span class="linenos">156</span></a>
</span><span id="DBManager-157"><a href="#DBManager-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">get_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sort_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DBManager-158"><a href="#DBManager-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-159"><a href="#DBManager-159"><span class="linenos">159</span></a><span class="sd">        Récupère les calibrations avec filtres et tri.</span>
</span><span id="DBManager-160"><a href="#DBManager-160"><span class="linenos">160</span></a>
</span><span id="DBManager-161"><a href="#DBManager-161"><span class="linenos">161</span></a><span class="sd">        :param filters: Un dictionnaire de filtres (optionnel).</span>
</span><span id="DBManager-162"><a href="#DBManager-162"><span class="linenos">162</span></a><span class="sd">        :param sort_by: Le critère de tri (optionnel).</span>
</span><span id="DBManager-163"><a href="#DBManager-163"><span class="linenos">163</span></a><span class="sd">        :return: Une liste de calibrations.</span>
</span><span id="DBManager-164"><a href="#DBManager-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-165"><a href="#DBManager-165"><span class="linenos">165</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM calibrations&quot;</span>
</span><span id="DBManager-166"><a href="#DBManager-166"><span class="linenos">166</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DBManager-167"><a href="#DBManager-167"><span class="linenos">167</span></a>
</span><span id="DBManager-168"><a href="#DBManager-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="n">filters</span><span class="p">:</span>
</span><span id="DBManager-169"><a href="#DBManager-169"><span class="linenos">169</span></a>            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DBManager-170"><a href="#DBManager-170"><span class="linenos">170</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DBManager-171"><a href="#DBManager-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
</span><span id="DBManager-172"><a href="#DBManager-172"><span class="linenos">172</span></a>                    <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> =?&quot;</span><span class="p">)</span>
</span><span id="DBManager-173"><a href="#DBManager-173"><span class="linenos">173</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="DBManager-174"><a href="#DBManager-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="n">conditions</span><span class="p">:</span>
</span><span id="DBManager-175"><a href="#DBManager-175"><span class="linenos">175</span></a>                <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">+</span> <span class="s2">&quot; AND &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
</span><span id="DBManager-176"><a href="#DBManager-176"><span class="linenos">176</span></a>
</span><span id="DBManager-177"><a href="#DBManager-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">sort_by</span><span class="p">:</span>
</span><span id="DBManager-178"><a href="#DBManager-178"><span class="linenos">178</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; ORDER BY </span><span class="si">{</span><span class="n">sort_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-179"><a href="#DBManager-179"><span class="linenos">179</span></a>
</span><span id="DBManager-180"><a href="#DBManager-180"><span class="linenos">180</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span> <span class="k">if</span> <span class="n">params</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="DBManager-181"><a href="#DBManager-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="n">result</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="DBManager-182"><a href="#DBManager-182"><span class="linenos">182</span></a>
</span><span id="DBManager-183"><a href="#DBManager-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">supprimer_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-184"><a href="#DBManager-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-185"><a href="#DBManager-185"><span class="linenos">185</span></a><span class="sd">        Supprime une calibration et ses paliers associés.</span>
</span><span id="DBManager-186"><a href="#DBManager-186"><span class="linenos">186</span></a>
</span><span id="DBManager-187"><a href="#DBManager-187"><span class="linenos">187</span></a><span class="sd">        :param calibration_id: L&#39;ID de la calibration à supprimer.</span>
</span><span id="DBManager-188"><a href="#DBManager-188"><span class="linenos">188</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la suppression</span>
</span><span id="DBManager-189"><a href="#DBManager-189"><span class="linenos">189</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager-190"><a href="#DBManager-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-191"><a href="#DBManager-191"><span class="linenos">191</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-192"><a href="#DBManager-192"><span class="linenos">192</span></a>            <span class="c1"># Supprimer d&#39;abord les paliers (contrainte de clé étrangère)</span>
</span><span id="DBManager-193"><a href="#DBManager-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-194"><a href="#DBManager-194"><span class="linenos">194</span></a><span class="s2">                DELETE FROM paliers </span>
</span><span id="DBManager-195"><a href="#DBManager-195"><span class="linenos">195</span></a><span class="s2">                WHERE calibration_id =?</span>
</span><span id="DBManager-196"><a href="#DBManager-196"><span class="linenos">196</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="DBManager-197"><a href="#DBManager-197"><span class="linenos">197</span></a>
</span><span id="DBManager-198"><a href="#DBManager-198"><span class="linenos">198</span></a>            <span class="c1"># Puis supprimer la calibration</span>
</span><span id="DBManager-199"><a href="#DBManager-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-200"><a href="#DBManager-200"><span class="linenos">200</span></a><span class="s2">                DELETE FROM calibrations </span>
</span><span id="DBManager-201"><a href="#DBManager-201"><span class="linenos">201</span></a><span class="s2">                WHERE id =?</span>
</span><span id="DBManager-202"><a href="#DBManager-202"><span class="linenos">202</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="DBManager-203"><a href="#DBManager-203"><span class="linenos">203</span></a>
</span><span id="DBManager-204"><a href="#DBManager-204"><span class="linenos">204</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration supprimée avec succès&quot;</span>
</span><span id="DBManager-205"><a href="#DBManager-205"><span class="linenos">205</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-206"><a href="#DBManager-206"><span class="linenos">206</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de la suppression : </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-207"><a href="#DBManager-207"><span class="linenos">207</span></a>
</span><span id="DBManager-208"><a href="#DBManager-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">exporter_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filtres</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-209"><a href="#DBManager-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-210"><a href="#DBManager-210"><span class="linenos">210</span></a><span class="sd">        Exporte les données avec filtres vers Excel.</span>
</span><span id="DBManager-211"><a href="#DBManager-211"><span class="linenos">211</span></a>
</span><span id="DBManager-212"><a href="#DBManager-212"><span class="linenos">212</span></a><span class="sd">        :param filtres: Dictionnaire des filtres à appliquer (optionnel).</span>
</span><span id="DBManager-213"><a href="#DBManager-213"><span class="linenos">213</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="DBManager-214"><a href="#DBManager-214"><span class="linenos">214</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager-215"><a href="#DBManager-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-216"><a href="#DBManager-216"><span class="linenos">216</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-217"><a href="#DBManager-217"><span class="linenos">217</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="DBManager-218"><a href="#DBManager-218"><span class="linenos">218</span></a>            <span class="n">ws_calibrations</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="DBManager-219"><a href="#DBManager-219"><span class="linenos">219</span></a>            <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Calibrations&quot;</span>
</span><span id="DBManager-220"><a href="#DBManager-220"><span class="linenos">220</span></a>
</span><span id="DBManager-221"><a href="#DBManager-221"><span class="linenos">221</span></a>            <span class="c1"># En-têtes</span>
</span><span id="DBManager-222"><a href="#DBManager-222"><span class="linenos">222</span></a>            <span class="n">calibrations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">(</span><span class="n">filtres</span><span class="p">)</span>
</span><span id="DBManager-223"><a href="#DBManager-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="DBManager-224"><a href="#DBManager-224"><span class="linenos">224</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DBManager-225"><a href="#DBManager-225"><span class="linenos">225</span></a>                    <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="DBManager-226"><a href="#DBManager-226"><span class="linenos">226</span></a>                    <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span>
</span><span id="DBManager-227"><a href="#DBManager-227"><span class="linenos">227</span></a>                <span class="p">]</span>
</span><span id="DBManager-228"><a href="#DBManager-228"><span class="linenos">228</span></a>                <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="DBManager-229"><a href="#DBManager-229"><span class="linenos">229</span></a>
</span><span id="DBManager-230"><a href="#DBManager-230"><span class="linenos">230</span></a>                <span class="c1"># Données</span>
</span><span id="DBManager-231"><a href="#DBManager-231"><span class="linenos">231</span></a>                <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="DBManager-232"><a href="#DBManager-232"><span class="linenos">232</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="DBManager-233"><a href="#DBManager-233"><span class="linenos">233</span></a>
</span><span id="DBManager-234"><a href="#DBManager-234"><span class="linenos">234</span></a>                <span class="c1"># Formatage</span>
</span><span id="DBManager-235"><a href="#DBManager-235"><span class="linenos">235</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DBManager-236"><a href="#DBManager-236"><span class="linenos">236</span></a>                    <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DBManager-237"><a href="#DBManager-237"><span class="linenos">237</span></a>                    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
</span><span id="DBManager-238"><a href="#DBManager-238"><span class="linenos">238</span></a>                        <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_length</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="DBManager-239"><a href="#DBManager-239"><span class="linenos">239</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="DBManager-240"><a href="#DBManager-240"><span class="linenos">240</span></a>
</span><span id="DBManager-241"><a href="#DBManager-241"><span class="linenos">241</span></a>            <span class="c1"># Nom de fichier avec date</span>
</span><span id="DBManager-242"><a href="#DBManager-242"><span class="linenos">242</span></a>            <span class="n">date_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="DBManager-243"><a href="#DBManager-243"><span class="linenos">243</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;export_capteurs_</span><span class="si">{</span><span class="n">date_str</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="DBManager-244"><a href="#DBManager-244"><span class="linenos">244</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DBManager-245"><a href="#DBManager-245"><span class="linenos">245</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Export réussi: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-246"><a href="#DBManager-246"><span class="linenos">246</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-247"><a href="#DBManager-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-248"><a href="#DBManager-248"><span class="linenos">248</span></a>
</span><span id="DBManager-249"><a href="#DBManager-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="nf">get_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-250"><a href="#DBManager-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-251"><a href="#DBManager-251"><span class="linenos">251</span></a><span class="sd">        Récupère la dernière calibration pour chaque capteur.</span>
</span><span id="DBManager-252"><a href="#DBManager-252"><span class="linenos">252</span></a>
</span><span id="DBManager-253"><a href="#DBManager-253"><span class="linenos">253</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="DBManager-254"><a href="#DBManager-254"><span class="linenos">254</span></a><span class="sd">                 et soit la liste des calibrations, soit un message d&#39;erreur.</span>
</span><span id="DBManager-255"><a href="#DBManager-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-256"><a href="#DBManager-256"><span class="linenos">256</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-257"><a href="#DBManager-257"><span class="linenos">257</span></a><span class="s2">            WITH DernieresCalibs AS (</span>
</span><span id="DBManager-258"><a href="#DBManager-258"><span class="linenos">258</span></a><span class="s2">                SELECT </span>
</span><span id="DBManager-259"><a href="#DBManager-259"><span class="linenos">259</span></a><span class="s2">                    c.*,</span>
</span><span id="DBManager-260"><a href="#DBManager-260"><span class="linenos">260</span></a><span class="s2">                    ROW_NUMBER() OVER (</span>
</span><span id="DBManager-261"><a href="#DBManager-261"><span class="linenos">261</span></a><span class="s2">                        PARTITION BY nom_capteur </span>
</span><span id="DBManager-262"><a href="#DBManager-262"><span class="linenos">262</span></a><span class="s2">                        ORDER BY date_test DESC, id DESC</span>
</span><span id="DBManager-263"><a href="#DBManager-263"><span class="linenos">263</span></a><span class="s2">                    ) as rn</span>
</span><span id="DBManager-264"><a href="#DBManager-264"><span class="linenos">264</span></a><span class="s2">                FROM calibrations c</span>
</span><span id="DBManager-265"><a href="#DBManager-265"><span class="linenos">265</span></a><span class="s2">            )</span>
</span><span id="DBManager-266"><a href="#DBManager-266"><span class="linenos">266</span></a><span class="s2">            SELECT * FROM DernieresCalibs</span>
</span><span id="DBManager-267"><a href="#DBManager-267"><span class="linenos">267</span></a><span class="s2">            WHERE rn = 1</span>
</span><span id="DBManager-268"><a href="#DBManager-268"><span class="linenos">268</span></a><span class="s2">            ORDER BY nom_capteur</span>
</span><span id="DBManager-269"><a href="#DBManager-269"><span class="linenos">269</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="DBManager-270"><a href="#DBManager-270"><span class="linenos">270</span></a>
</span><span id="DBManager-271"><a href="#DBManager-271"><span class="linenos">271</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="DBManager-272"><a href="#DBManager-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager-273"><a href="#DBManager-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de la récupération des dernières calibrations&quot;</span>
</span><span id="DBManager-274"><a href="#DBManager-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="DBManager-275"><a href="#DBManager-275"><span class="linenos">275</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Aucune calibration trouvée&quot;</span>
</span><span id="DBManager-276"><a href="#DBManager-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span>
</span><span id="DBManager-277"><a href="#DBManager-277"><span class="linenos">277</span></a>
</span><span id="DBManager-278"><a href="#DBManager-278"><span class="linenos">278</span></a>    <span class="k">def</span> <span class="nf">get_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-279"><a href="#DBManager-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-280"><a href="#DBManager-280"><span class="linenos">280</span></a><span class="sd">        Récupère la dernière calibration pour chaque capteur.</span>
</span><span id="DBManager-281"><a href="#DBManager-281"><span class="linenos">281</span></a>
</span><span id="DBManager-282"><a href="#DBManager-282"><span class="linenos">282</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="DBManager-283"><a href="#DBManager-283"><span class="linenos">283</span></a><span class="sd">                 et soit la liste des calibrations, soit un message d&#39;erreur.</span>
</span><span id="DBManager-284"><a href="#DBManager-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-285"><a href="#DBManager-285"><span class="linenos">285</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager-286"><a href="#DBManager-286"><span class="linenos">286</span></a><span class="s2">            WITH DernieresCalibs AS (</span>
</span><span id="DBManager-287"><a href="#DBManager-287"><span class="linenos">287</span></a><span class="s2">                SELECT </span>
</span><span id="DBManager-288"><a href="#DBManager-288"><span class="linenos">288</span></a><span class="s2">                    c.*,</span>
</span><span id="DBManager-289"><a href="#DBManager-289"><span class="linenos">289</span></a><span class="s2">                    ROW_NUMBER() OVER (</span>
</span><span id="DBManager-290"><a href="#DBManager-290"><span class="linenos">290</span></a><span class="s2">                        PARTITION BY nom_capteur </span>
</span><span id="DBManager-291"><a href="#DBManager-291"><span class="linenos">291</span></a><span class="s2">                        ORDER BY date_test DESC, id DESC</span>
</span><span id="DBManager-292"><a href="#DBManager-292"><span class="linenos">292</span></a><span class="s2">                    ) as rn</span>
</span><span id="DBManager-293"><a href="#DBManager-293"><span class="linenos">293</span></a><span class="s2">                FROM calibrations c</span>
</span><span id="DBManager-294"><a href="#DBManager-294"><span class="linenos">294</span></a><span class="s2">            )</span>
</span><span id="DBManager-295"><a href="#DBManager-295"><span class="linenos">295</span></a><span class="s2">            SELECT * FROM DernieresCalibs</span>
</span><span id="DBManager-296"><a href="#DBManager-296"><span class="linenos">296</span></a><span class="s2">            WHERE rn = 1</span>
</span><span id="DBManager-297"><a href="#DBManager-297"><span class="linenos">297</span></a><span class="s2">            ORDER BY nom_capteur</span>
</span><span id="DBManager-298"><a href="#DBManager-298"><span class="linenos">298</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="DBManager-299"><a href="#DBManager-299"><span class="linenos">299</span></a>
</span><span id="DBManager-300"><a href="#DBManager-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="DBManager-301"><a href="#DBManager-301"><span class="linenos">301</span></a>
</span><span id="DBManager-302"><a href="#DBManager-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">exporter_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager-303"><a href="#DBManager-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager-304"><a href="#DBManager-304"><span class="linenos">304</span></a><span class="sd">        Exporte les dernières calibrations pour chaque capteur dans un fichier Excel.</span>
</span><span id="DBManager-305"><a href="#DBManager-305"><span class="linenos">305</span></a>
</span><span id="DBManager-306"><a href="#DBManager-306"><span class="linenos">306</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="DBManager-307"><a href="#DBManager-307"><span class="linenos">307</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager-308"><a href="#DBManager-308"><span class="linenos">308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager-309"><a href="#DBManager-309"><span class="linenos">309</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager-310"><a href="#DBManager-310"><span class="linenos">310</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dernieres_calibrations</span><span class="p">()</span>
</span><span id="DBManager-311"><a href="#DBManager-311"><span class="linenos">311</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager-312"><a href="#DBManager-312"><span class="linenos">312</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de la récupération des dernières calibrations&quot;</span>
</span><span id="DBManager-313"><a href="#DBManager-313"><span class="linenos">313</span></a>
</span><span id="DBManager-314"><a href="#DBManager-314"><span class="linenos">314</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="DBManager-315"><a href="#DBManager-315"><span class="linenos">315</span></a>            <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="DBManager-316"><a href="#DBManager-316"><span class="linenos">316</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Dernières Calibrations&quot;</span>
</span><span id="DBManager-317"><a href="#DBManager-317"><span class="linenos">317</span></a>
</span><span id="DBManager-318"><a href="#DBManager-318"><span class="linenos">318</span></a>            <span class="c1"># Ajouter les en-têtes</span>
</span><span id="DBManager-319"><a href="#DBManager-319"><span class="linenos">319</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="DBManager-320"><a href="#DBManager-320"><span class="linenos">320</span></a>                       <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span><span class="p">]</span>
</span><span id="DBManager-321"><a href="#DBManager-321"><span class="linenos">321</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="DBManager-322"><a href="#DBManager-322"><span class="linenos">322</span></a>
</span><span id="DBManager-323"><a href="#DBManager-323"><span class="linenos">323</span></a>            <span class="c1"># Ajouter les données</span>
</span><span id="DBManager-324"><a href="#DBManager-324"><span class="linenos">324</span></a>            <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="DBManager-325"><a href="#DBManager-325"><span class="linenos">325</span></a>                <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="DBManager-326"><a href="#DBManager-326"><span class="linenos">326</span></a>
</span><span id="DBManager-327"><a href="#DBManager-327"><span class="linenos">327</span></a>            <span class="c1"># Sauvegarde du fichier avec un horodatage unique</span>
</span><span id="DBManager-328"><a href="#DBManager-328"><span class="linenos">328</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dernieres_calibrations_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="DBManager-329"><a href="#DBManager-329"><span class="linenos">329</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DBManager-330"><a href="#DBManager-330"><span class="linenos">330</span></a>
</span><span id="DBManager-331"><a href="#DBManager-331"><span class="linenos">331</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Les dernières calibrations ont été exportées dans </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager-332"><a href="#DBManager-332"><span class="linenos">332</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager-333"><a href="#DBManager-333"><span class="linenos">333</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Gestionnaire de base de données pour les capteurs.</p>

<p>Cette classe permet de gérer les données de calibration des capteurs dans une base de données SQLite.
Elle fournit des méthodes pour ajouter, supprimer, récupérer et exporter les données de calibration.</p>
</div>


                            <div id="DBManager.__init__" class="classattr">
                                        <input id="DBManager.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DBManager</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">db_path</span><span class="o">=</span><span class="s1">&#39;capteurs.db&#39;</span></span>)</span>

                <label class="view-source-button" for="DBManager.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.__init__-20"><a href="#DBManager.__init__-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_path</span><span class="o">=</span><span class="s1">&#39;capteurs.db&#39;</span><span class="p">):</span>
</span><span id="DBManager.__init__-21"><a href="#DBManager.__init__-21"><span class="linenos">21</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.__init__-22"><a href="#DBManager.__init__-22"><span class="linenos">22</span></a><span class="sd">        Initialisation du gestionnaire de base de données.</span>
</span><span id="DBManager.__init__-23"><a href="#DBManager.__init__-23"><span class="linenos">23</span></a>
</span><span id="DBManager.__init__-24"><a href="#DBManager.__init__-24"><span class="linenos">24</span></a><span class="sd">        :param db_path: Chemin de la base de données SQLite (par défaut : &#39;capteurs.db&#39;).</span>
</span><span id="DBManager.__init__-25"><a href="#DBManager.__init__-25"><span class="linenos">25</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.__init__-26"><a href="#DBManager.__init__-26"><span class="linenos">26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="DBManager.__init__-27"><a href="#DBManager.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DBManager.__init__-28"><a href="#DBManager.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DBManager.__init__-29"><a href="#DBManager.__init__-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialisation du gestionnaire de base de données.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>db_path: Chemin de la base de données SQLite (par défaut</strong>:  'capteurs.db').</li>
</ul>
</div>


                            </div>
                            <div id="DBManager.db_path" class="classattr">
                                <div class="attr variable">
            <span class="name">db_path</span>

        
    </div>
    <a class="headerlink" href="#DBManager.db_path"></a>
    
    

                            </div>
                            <div id="DBManager.conn" class="classattr">
                                <div class="attr variable">
            <span class="name">conn</span>

        
    </div>
    <a class="headerlink" href="#DBManager.conn"></a>
    
    

                            </div>
                            <div id="DBManager.cursor" class="classattr">
                                <div class="attr variable">
            <span class="name">cursor</span>

        
    </div>
    <a class="headerlink" href="#DBManager.cursor"></a>
    
    

                            </div>
                            <div id="DBManager.connect" class="classattr">
                                        <input id="DBManager.connect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DBManager.connect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.connect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.connect-31"><a href="#DBManager.connect-31"><span class="linenos">31</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DBManager.connect-32"><a href="#DBManager.connect-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.connect-33"><a href="#DBManager.connect-33"><span class="linenos">33</span></a><span class="sd">        Établit la connexion à la base de données.</span>
</span><span id="DBManager.connect-34"><a href="#DBManager.connect-34"><span class="linenos">34</span></a>
</span><span id="DBManager.connect-35"><a href="#DBManager.connect-35"><span class="linenos">35</span></a><span class="sd">        :return: True si la connexion réussit, False sinon.</span>
</span><span id="DBManager.connect-36"><a href="#DBManager.connect-36"><span class="linenos">36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.connect-37"><a href="#DBManager.connect-37"><span class="linenos">37</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.connect-38"><a href="#DBManager.connect-38"><span class="linenos">38</span></a>            <span class="c1"># Établir la connexion à la base de données</span>
</span><span id="DBManager.connect-39"><a href="#DBManager.connect-39"><span class="linenos">39</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="DBManager.connect-40"><a href="#DBManager.connect-40"><span class="linenos">40</span></a>            <span class="c1"># Créer un curseur pour exécuter les requêtes</span>
</span><span id="DBManager.connect-41"><a href="#DBManager.connect-41"><span class="linenos">41</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="DBManager.connect-42"><a href="#DBManager.connect-42"><span class="linenos">42</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DBManager.connect-43"><a href="#DBManager.connect-43"><span class="linenos">43</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.connect-44"><a href="#DBManager.connect-44"><span class="linenos">44</span></a>            <span class="c1"># Gérer les erreurs de connexion</span>
</span><span id="DBManager.connect-45"><a href="#DBManager.connect-45"><span class="linenos">45</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur de connexion : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DBManager.connect-46"><a href="#DBManager.connect-46"><span class="linenos">46</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Établit la connexion à la base de données.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>True si la connexion réussit, False sinon.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.disconnect" class="classattr">
                                        <input id="DBManager.disconnect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">disconnect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DBManager.disconnect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.disconnect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.disconnect-48"><a href="#DBManager.disconnect-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DBManager.disconnect-49"><a href="#DBManager.disconnect-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.disconnect-50"><a href="#DBManager.disconnect-50"><span class="linenos">50</span></a><span class="sd">        Ferme la connexion à la base de données.</span>
</span><span id="DBManager.disconnect-51"><a href="#DBManager.disconnect-51"><span class="linenos">51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.disconnect-52"><a href="#DBManager.disconnect-52"><span class="linenos">52</span></a>        <span class="c1"># Fermer la connexion si elle est établie</span>
</span><span id="DBManager.disconnect-53"><a href="#DBManager.disconnect-53"><span class="linenos">53</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
</span><span id="DBManager.disconnect-54"><a href="#DBManager.disconnect-54"><span class="linenos">54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Ferme la connexion à la base de données.</p>
</div>


                            </div>
                            <div id="DBManager.execute_query" class="classattr">
                                        <input id="DBManager.execute_query-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_query</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">query</span>, </span><span class="param"><span class="n">params</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DBManager.execute_query-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.execute_query"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.execute_query-56"><a href="#DBManager.execute_query-56"><span class="linenos">56</span></a>    <span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DBManager.execute_query-57"><a href="#DBManager.execute_query-57"><span class="linenos">57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.execute_query-58"><a href="#DBManager.execute_query-58"><span class="linenos">58</span></a><span class="sd">        Exécute une requête SQL avec gestion des erreurs et commit.</span>
</span><span id="DBManager.execute_query-59"><a href="#DBManager.execute_query-59"><span class="linenos">59</span></a>
</span><span id="DBManager.execute_query-60"><a href="#DBManager.execute_query-60"><span class="linenos">60</span></a><span class="sd">        :param query: La requête SQL à exécuter.</span>
</span><span id="DBManager.execute_query-61"><a href="#DBManager.execute_query-61"><span class="linenos">61</span></a><span class="sd">        :param params: Les paramètres à passer à la requête (optionnel).</span>
</span><span id="DBManager.execute_query-62"><a href="#DBManager.execute_query-62"><span class="linenos">62</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="DBManager.execute_query-63"><a href="#DBManager.execute_query-63"><span class="linenos">63</span></a><span class="sd">                 et le résultat de la requête (None si pas de résultat).</span>
</span><span id="DBManager.execute_query-64"><a href="#DBManager.execute_query-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.execute_query-65"><a href="#DBManager.execute_query-65"><span class="linenos">65</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.execute_query-66"><a href="#DBManager.execute_query-66"><span class="linenos">66</span></a>            <span class="c1"># Exécuter la requête avec les paramètres</span>
</span><span id="DBManager.execute_query-67"><a href="#DBManager.execute_query-67"><span class="linenos">67</span></a>            <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
</span><span id="DBManager.execute_query-68"><a href="#DBManager.execute_query-68"><span class="linenos">68</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="DBManager.execute_query-69"><a href="#DBManager.execute_query-69"><span class="linenos">69</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DBManager.execute_query-70"><a href="#DBManager.execute_query-70"><span class="linenos">70</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="DBManager.execute_query-71"><a href="#DBManager.execute_query-71"><span class="linenos">71</span></a>            <span class="c1"># Valider les modifications</span>
</span><span id="DBManager.execute_query-72"><a href="#DBManager.execute_query-72"><span class="linenos">72</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="DBManager.execute_query-73"><a href="#DBManager.execute_query-73"><span class="linenos">73</span></a>            <span class="c1"># Récupérer le résultat de la requête si elle est une requête de sélection</span>
</span><span id="DBManager.execute_query-74"><a href="#DBManager.execute_query-74"><span class="linenos">74</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;SELECT&quot;</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="DBManager.execute_query-75"><a href="#DBManager.execute_query-75"><span class="linenos">75</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span>
</span><span id="DBManager.execute_query-76"><a href="#DBManager.execute_query-76"><span class="linenos">76</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.execute_query-77"><a href="#DBManager.execute_query-77"><span class="linenos">77</span></a>            <span class="c1"># Gérer les erreurs de requête</span>
</span><span id="DBManager.execute_query-78"><a href="#DBManager.execute_query-78"><span class="linenos">78</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="DBManager.execute_query-79"><a href="#DBManager.execute_query-79"><span class="linenos">79</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Exécute une requête SQL avec gestion des erreurs et commit.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>query</strong>:  La requête SQL à exécuter.</li>
<li><strong>params</strong>:  Les paramètres à passer à la requête (optionnel).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de la requête
           et le résultat de la requête (None si pas de résultat).</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.ajouter_calibration" class="classattr">
                                        <input id="DBManager.ajouter_calibration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ajouter_calibration</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">date_test</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">numcapteur</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">nom_utilisateur</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">fichier</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">coef_a</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">coef_b</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">a_reg</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">b_reg</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">datat1</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">datat2</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DBManager.ajouter_calibration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.ajouter_calibration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.ajouter_calibration-81"><a href="#DBManager.ajouter_calibration-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="nf">ajouter_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date_test</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">numcapteur</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fichier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DBManager.ajouter_calibration-82"><a href="#DBManager.ajouter_calibration-82"><span class="linenos"> 82</span></a>                            <span class="n">coef_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">datat1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">datat2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager.ajouter_calibration-83"><a href="#DBManager.ajouter_calibration-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.ajouter_calibration-84"><a href="#DBManager.ajouter_calibration-84"><span class="linenos"> 84</span></a><span class="sd">        Ajoute une calibration avec les paliers associés.</span>
</span><span id="DBManager.ajouter_calibration-85"><a href="#DBManager.ajouter_calibration-85"><span class="linenos"> 85</span></a>
</span><span id="DBManager.ajouter_calibration-86"><a href="#DBManager.ajouter_calibration-86"><span class="linenos"> 86</span></a><span class="sd">        :param date_test: Date du test.</span>
</span><span id="DBManager.ajouter_calibration-87"><a href="#DBManager.ajouter_calibration-87"><span class="linenos"> 87</span></a><span class="sd">        :param numcapteur: Numéro du capteur.</span>
</span><span id="DBManager.ajouter_calibration-88"><a href="#DBManager.ajouter_calibration-88"><span class="linenos"> 88</span></a><span class="sd">        :param nom_utilisateur: Nom de l&#39;utilisateur.</span>
</span><span id="DBManager.ajouter_calibration-89"><a href="#DBManager.ajouter_calibration-89"><span class="linenos"> 89</span></a><span class="sd">        :param fichier: Nom du fichier source.</span>
</span><span id="DBManager.ajouter_calibration-90"><a href="#DBManager.ajouter_calibration-90"><span class="linenos"> 90</span></a><span class="sd">        :param coef_a: Coefficient de conversion a.</span>
</span><span id="DBManager.ajouter_calibration-91"><a href="#DBManager.ajouter_calibration-91"><span class="linenos"> 91</span></a><span class="sd">        :param coef_b: Coefficient de conversion b.</span>
</span><span id="DBManager.ajouter_calibration-92"><a href="#DBManager.ajouter_calibration-92"><span class="linenos"> 92</span></a><span class="sd">        :param a_reg: Coefficient capteur a.</span>
</span><span id="DBManager.ajouter_calibration-93"><a href="#DBManager.ajouter_calibration-93"><span class="linenos"> 93</span></a><span class="sd">        :param b_reg: Coefficient capteur b.</span>
</span><span id="DBManager.ajouter_calibration-94"><a href="#DBManager.ajouter_calibration-94"><span class="linenos"> 94</span></a><span class="sd">        :param datat1: Liste des données t1 pour les paliers.</span>
</span><span id="DBManager.ajouter_calibration-95"><a href="#DBManager.ajouter_calibration-95"><span class="linenos"> 95</span></a><span class="sd">        :param datat2: Liste des données t2 pour les paliers.</span>
</span><span id="DBManager.ajouter_calibration-96"><a href="#DBManager.ajouter_calibration-96"><span class="linenos"> 96</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;ajout</span>
</span><span id="DBManager.ajouter_calibration-97"><a href="#DBManager.ajouter_calibration-97"><span class="linenos"> 97</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager.ajouter_calibration-98"><a href="#DBManager.ajouter_calibration-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.ajouter_calibration-99"><a href="#DBManager.ajouter_calibration-99"><span class="linenos"> 99</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.ajouter_calibration-100"><a href="#DBManager.ajouter_calibration-100"><span class="linenos">100</span></a>            <span class="c1"># Insertion de la calibration</span>
</span><span id="DBManager.ajouter_calibration-101"><a href="#DBManager.ajouter_calibration-101"><span class="linenos">101</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager.ajouter_calibration-102"><a href="#DBManager.ajouter_calibration-102"><span class="linenos">102</span></a><span class="s2">                INSERT INTO calibrations (</span>
</span><span id="DBManager.ajouter_calibration-103"><a href="#DBManager.ajouter_calibration-103"><span class="linenos">103</span></a><span class="s2">                    date_test, version_logiciel, nom_capteur, operateur,</span>
</span><span id="DBManager.ajouter_calibration-104"><a href="#DBManager.ajouter_calibration-104"><span class="linenos">104</span></a><span class="s2">                    fichier_source, coef_conversion_a, coef_conversion_b,</span>
</span><span id="DBManager.ajouter_calibration-105"><a href="#DBManager.ajouter_calibration-105"><span class="linenos">105</span></a><span class="s2">                    coef_capteur_a, coef_capteur_b</span>
</span><span id="DBManager.ajouter_calibration-106"><a href="#DBManager.ajouter_calibration-106"><span class="linenos">106</span></a><span class="s2">                ) VALUES (?,?,?,?,?,?,?,?,?)</span>
</span><span id="DBManager.ajouter_calibration-107"><a href="#DBManager.ajouter_calibration-107"><span class="linenos">107</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="DBManager.ajouter_calibration-108"><a href="#DBManager.ajouter_calibration-108"><span class="linenos">108</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">date_test</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">version</span><span class="p">(),</span> <span class="n">numcapteur</span><span class="p">,</span> <span class="n">nom_utilisateur</span><span class="p">,</span>
</span><span id="DBManager.ajouter_calibration-109"><a href="#DBManager.ajouter_calibration-109"><span class="linenos">109</span></a>                      <span class="n">fichier</span><span class="p">,</span> <span class="n">coef_a</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">,</span> <span class="n">a_reg</span><span class="p">,</span> <span class="n">b_reg</span><span class="p">)</span>
</span><span id="DBManager.ajouter_calibration-110"><a href="#DBManager.ajouter_calibration-110"><span class="linenos">110</span></a>
</span><span id="DBManager.ajouter_calibration-111"><a href="#DBManager.ajouter_calibration-111"><span class="linenos">111</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="DBManager.ajouter_calibration-112"><a href="#DBManager.ajouter_calibration-112"><span class="linenos">112</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager.ajouter_calibration-113"><a href="#DBManager.ajouter_calibration-113"><span class="linenos">113</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de l&#39;insertion de la calibration&quot;</span>
</span><span id="DBManager.ajouter_calibration-114"><a href="#DBManager.ajouter_calibration-114"><span class="linenos">114</span></a>
</span><span id="DBManager.ajouter_calibration-115"><a href="#DBManager.ajouter_calibration-115"><span class="linenos">115</span></a>            <span class="n">calibration_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">lastrowid</span>
</span><span id="DBManager.ajouter_calibration-116"><a href="#DBManager.ajouter_calibration-116"><span class="linenos">116</span></a>
</span><span id="DBManager.ajouter_calibration-117"><a href="#DBManager.ajouter_calibration-117"><span class="linenos">117</span></a>            <span class="c1"># Insertion des paliers</span>
</span><span id="DBManager.ajouter_calibration-118"><a href="#DBManager.ajouter_calibration-118"><span class="linenos">118</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datat1</span><span class="p">)):</span>
</span><span id="DBManager.ajouter_calibration-119"><a href="#DBManager.ajouter_calibration-119"><span class="linenos">119</span></a>                <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ajouter_palier</span><span class="p">(</span><span class="n">calibration_id</span><span class="p">,</span> <span class="n">datat1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">datat2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DBManager.ajouter_calibration-120"><a href="#DBManager.ajouter_calibration-120"><span class="linenos">120</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager.ajouter_calibration-121"><a href="#DBManager.ajouter_calibration-121"><span class="linenos">121</span></a>                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;insertion du palier </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager.ajouter_calibration-122"><a href="#DBManager.ajouter_calibration-122"><span class="linenos">122</span></a>
</span><span id="DBManager.ajouter_calibration-123"><a href="#DBManager.ajouter_calibration-123"><span class="linenos">123</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration ajoutée avec succès&quot;</span>
</span><span id="DBManager.ajouter_calibration-124"><a href="#DBManager.ajouter_calibration-124"><span class="linenos">124</span></a>
</span><span id="DBManager.ajouter_calibration-125"><a href="#DBManager.ajouter_calibration-125"><span class="linenos">125</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.ajouter_calibration-126"><a href="#DBManager.ajouter_calibration-126"><span class="linenos">126</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ajoute une calibration avec les paliers associés.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>date_test</strong>:  Date du test.</li>
<li><strong>numcapteur</strong>:  Numéro du capteur.</li>
<li><strong>nom_utilisateur</strong>:  Nom de l'utilisateur.</li>
<li><strong>fichier</strong>:  Nom du fichier source.</li>
<li><strong>coef_a</strong>:  Coefficient de conversion a.</li>
<li><strong>coef_b</strong>:  Coefficient de conversion b.</li>
<li><strong>a_reg</strong>:  Coefficient capteur a.</li>
<li><strong>b_reg</strong>:  Coefficient capteur b.</li>
<li><strong>datat1</strong>:  Liste des données t1 pour les paliers.</li>
<li><strong>datat2</strong>:  Liste des données t2 pour les paliers.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de l'ajout
           et un message de résultat.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.get_calibrations" class="classattr">
                                        <input id="DBManager.get_calibrations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_calibrations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">sort_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="DBManager.get_calibrations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.get_calibrations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.get_calibrations-157"><a href="#DBManager.get_calibrations-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">get_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sort_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DBManager.get_calibrations-158"><a href="#DBManager.get_calibrations-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.get_calibrations-159"><a href="#DBManager.get_calibrations-159"><span class="linenos">159</span></a><span class="sd">        Récupère les calibrations avec filtres et tri.</span>
</span><span id="DBManager.get_calibrations-160"><a href="#DBManager.get_calibrations-160"><span class="linenos">160</span></a>
</span><span id="DBManager.get_calibrations-161"><a href="#DBManager.get_calibrations-161"><span class="linenos">161</span></a><span class="sd">        :param filters: Un dictionnaire de filtres (optionnel).</span>
</span><span id="DBManager.get_calibrations-162"><a href="#DBManager.get_calibrations-162"><span class="linenos">162</span></a><span class="sd">        :param sort_by: Le critère de tri (optionnel).</span>
</span><span id="DBManager.get_calibrations-163"><a href="#DBManager.get_calibrations-163"><span class="linenos">163</span></a><span class="sd">        :return: Une liste de calibrations.</span>
</span><span id="DBManager.get_calibrations-164"><a href="#DBManager.get_calibrations-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.get_calibrations-165"><a href="#DBManager.get_calibrations-165"><span class="linenos">165</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM calibrations&quot;</span>
</span><span id="DBManager.get_calibrations-166"><a href="#DBManager.get_calibrations-166"><span class="linenos">166</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DBManager.get_calibrations-167"><a href="#DBManager.get_calibrations-167"><span class="linenos">167</span></a>
</span><span id="DBManager.get_calibrations-168"><a href="#DBManager.get_calibrations-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="n">filters</span><span class="p">:</span>
</span><span id="DBManager.get_calibrations-169"><a href="#DBManager.get_calibrations-169"><span class="linenos">169</span></a>            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DBManager.get_calibrations-170"><a href="#DBManager.get_calibrations-170"><span class="linenos">170</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DBManager.get_calibrations-171"><a href="#DBManager.get_calibrations-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
</span><span id="DBManager.get_calibrations-172"><a href="#DBManager.get_calibrations-172"><span class="linenos">172</span></a>                    <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> =?&quot;</span><span class="p">)</span>
</span><span id="DBManager.get_calibrations-173"><a href="#DBManager.get_calibrations-173"><span class="linenos">173</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="DBManager.get_calibrations-174"><a href="#DBManager.get_calibrations-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="n">conditions</span><span class="p">:</span>
</span><span id="DBManager.get_calibrations-175"><a href="#DBManager.get_calibrations-175"><span class="linenos">175</span></a>                <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">+</span> <span class="s2">&quot; AND &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
</span><span id="DBManager.get_calibrations-176"><a href="#DBManager.get_calibrations-176"><span class="linenos">176</span></a>
</span><span id="DBManager.get_calibrations-177"><a href="#DBManager.get_calibrations-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">sort_by</span><span class="p">:</span>
</span><span id="DBManager.get_calibrations-178"><a href="#DBManager.get_calibrations-178"><span class="linenos">178</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; ORDER BY </span><span class="si">{</span><span class="n">sort_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager.get_calibrations-179"><a href="#DBManager.get_calibrations-179"><span class="linenos">179</span></a>
</span><span id="DBManager.get_calibrations-180"><a href="#DBManager.get_calibrations-180"><span class="linenos">180</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span> <span class="k">if</span> <span class="n">params</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="DBManager.get_calibrations-181"><a href="#DBManager.get_calibrations-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="n">result</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Récupère les calibrations avec filtres et tri.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filters</strong>:  Un dictionnaire de filtres (optionnel).</li>
<li><strong>sort_by</strong>:  Le critère de tri (optionnel).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Une liste de calibrations.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.supprimer_calibration" class="classattr">
                                        <input id="DBManager.supprimer_calibration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">supprimer_calibration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DBManager.supprimer_calibration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.supprimer_calibration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.supprimer_calibration-183"><a href="#DBManager.supprimer_calibration-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">supprimer_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager.supprimer_calibration-184"><a href="#DBManager.supprimer_calibration-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.supprimer_calibration-185"><a href="#DBManager.supprimer_calibration-185"><span class="linenos">185</span></a><span class="sd">        Supprime une calibration et ses paliers associés.</span>
</span><span id="DBManager.supprimer_calibration-186"><a href="#DBManager.supprimer_calibration-186"><span class="linenos">186</span></a>
</span><span id="DBManager.supprimer_calibration-187"><a href="#DBManager.supprimer_calibration-187"><span class="linenos">187</span></a><span class="sd">        :param calibration_id: L&#39;ID de la calibration à supprimer.</span>
</span><span id="DBManager.supprimer_calibration-188"><a href="#DBManager.supprimer_calibration-188"><span class="linenos">188</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la suppression</span>
</span><span id="DBManager.supprimer_calibration-189"><a href="#DBManager.supprimer_calibration-189"><span class="linenos">189</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager.supprimer_calibration-190"><a href="#DBManager.supprimer_calibration-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.supprimer_calibration-191"><a href="#DBManager.supprimer_calibration-191"><span class="linenos">191</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.supprimer_calibration-192"><a href="#DBManager.supprimer_calibration-192"><span class="linenos">192</span></a>            <span class="c1"># Supprimer d&#39;abord les paliers (contrainte de clé étrangère)</span>
</span><span id="DBManager.supprimer_calibration-193"><a href="#DBManager.supprimer_calibration-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager.supprimer_calibration-194"><a href="#DBManager.supprimer_calibration-194"><span class="linenos">194</span></a><span class="s2">                DELETE FROM paliers </span>
</span><span id="DBManager.supprimer_calibration-195"><a href="#DBManager.supprimer_calibration-195"><span class="linenos">195</span></a><span class="s2">                WHERE calibration_id =?</span>
</span><span id="DBManager.supprimer_calibration-196"><a href="#DBManager.supprimer_calibration-196"><span class="linenos">196</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="DBManager.supprimer_calibration-197"><a href="#DBManager.supprimer_calibration-197"><span class="linenos">197</span></a>
</span><span id="DBManager.supprimer_calibration-198"><a href="#DBManager.supprimer_calibration-198"><span class="linenos">198</span></a>            <span class="c1"># Puis supprimer la calibration</span>
</span><span id="DBManager.supprimer_calibration-199"><a href="#DBManager.supprimer_calibration-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager.supprimer_calibration-200"><a href="#DBManager.supprimer_calibration-200"><span class="linenos">200</span></a><span class="s2">                DELETE FROM calibrations </span>
</span><span id="DBManager.supprimer_calibration-201"><a href="#DBManager.supprimer_calibration-201"><span class="linenos">201</span></a><span class="s2">                WHERE id =?</span>
</span><span id="DBManager.supprimer_calibration-202"><a href="#DBManager.supprimer_calibration-202"><span class="linenos">202</span></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">calibration_id</span><span class="p">,))</span>
</span><span id="DBManager.supprimer_calibration-203"><a href="#DBManager.supprimer_calibration-203"><span class="linenos">203</span></a>
</span><span id="DBManager.supprimer_calibration-204"><a href="#DBManager.supprimer_calibration-204"><span class="linenos">204</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Calibration supprimée avec succès&quot;</span>
</span><span id="DBManager.supprimer_calibration-205"><a href="#DBManager.supprimer_calibration-205"><span class="linenos">205</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.supprimer_calibration-206"><a href="#DBManager.supprimer_calibration-206"><span class="linenos">206</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de la suppression : </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Supprime une calibration et ses paliers associés.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>calibration_id</strong>:  L'ID de la calibration à supprimer.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de la suppression
           et un message de résultat.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.exporter_excel" class="classattr">
                                        <input id="DBManager.exporter_excel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exporter_excel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filtres</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DBManager.exporter_excel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.exporter_excel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.exporter_excel-208"><a href="#DBManager.exporter_excel-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">exporter_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filtres</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-209"><a href="#DBManager.exporter_excel-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.exporter_excel-210"><a href="#DBManager.exporter_excel-210"><span class="linenos">210</span></a><span class="sd">        Exporte les données avec filtres vers Excel.</span>
</span><span id="DBManager.exporter_excel-211"><a href="#DBManager.exporter_excel-211"><span class="linenos">211</span></a>
</span><span id="DBManager.exporter_excel-212"><a href="#DBManager.exporter_excel-212"><span class="linenos">212</span></a><span class="sd">        :param filtres: Dictionnaire des filtres à appliquer (optionnel).</span>
</span><span id="DBManager.exporter_excel-213"><a href="#DBManager.exporter_excel-213"><span class="linenos">213</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="DBManager.exporter_excel-214"><a href="#DBManager.exporter_excel-214"><span class="linenos">214</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager.exporter_excel-215"><a href="#DBManager.exporter_excel-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.exporter_excel-216"><a href="#DBManager.exporter_excel-216"><span class="linenos">216</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-217"><a href="#DBManager.exporter_excel-217"><span class="linenos">217</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="DBManager.exporter_excel-218"><a href="#DBManager.exporter_excel-218"><span class="linenos">218</span></a>            <span class="n">ws_calibrations</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="DBManager.exporter_excel-219"><a href="#DBManager.exporter_excel-219"><span class="linenos">219</span></a>            <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Calibrations&quot;</span>
</span><span id="DBManager.exporter_excel-220"><a href="#DBManager.exporter_excel-220"><span class="linenos">220</span></a>
</span><span id="DBManager.exporter_excel-221"><a href="#DBManager.exporter_excel-221"><span class="linenos">221</span></a>            <span class="c1"># En-têtes</span>
</span><span id="DBManager.exporter_excel-222"><a href="#DBManager.exporter_excel-222"><span class="linenos">222</span></a>            <span class="n">calibrations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">(</span><span class="n">filtres</span><span class="p">)</span>
</span><span id="DBManager.exporter_excel-223"><a href="#DBManager.exporter_excel-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-224"><a href="#DBManager.exporter_excel-224"><span class="linenos">224</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DBManager.exporter_excel-225"><a href="#DBManager.exporter_excel-225"><span class="linenos">225</span></a>                    <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="DBManager.exporter_excel-226"><a href="#DBManager.exporter_excel-226"><span class="linenos">226</span></a>                    <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span>
</span><span id="DBManager.exporter_excel-227"><a href="#DBManager.exporter_excel-227"><span class="linenos">227</span></a>                <span class="p">]</span>
</span><span id="DBManager.exporter_excel-228"><a href="#DBManager.exporter_excel-228"><span class="linenos">228</span></a>                <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="DBManager.exporter_excel-229"><a href="#DBManager.exporter_excel-229"><span class="linenos">229</span></a>
</span><span id="DBManager.exporter_excel-230"><a href="#DBManager.exporter_excel-230"><span class="linenos">230</span></a>                <span class="c1"># Données</span>
</span><span id="DBManager.exporter_excel-231"><a href="#DBManager.exporter_excel-231"><span class="linenos">231</span></a>                <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-232"><a href="#DBManager.exporter_excel-232"><span class="linenos">232</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="DBManager.exporter_excel-233"><a href="#DBManager.exporter_excel-233"><span class="linenos">233</span></a>
</span><span id="DBManager.exporter_excel-234"><a href="#DBManager.exporter_excel-234"><span class="linenos">234</span></a>                <span class="c1"># Formatage</span>
</span><span id="DBManager.exporter_excel-235"><a href="#DBManager.exporter_excel-235"><span class="linenos">235</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-236"><a href="#DBManager.exporter_excel-236"><span class="linenos">236</span></a>                    <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DBManager.exporter_excel-237"><a href="#DBManager.exporter_excel-237"><span class="linenos">237</span></a>                    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-238"><a href="#DBManager.exporter_excel-238"><span class="linenos">238</span></a>                        <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_length</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="DBManager.exporter_excel-239"><a href="#DBManager.exporter_excel-239"><span class="linenos">239</span></a>                    <span class="n">ws_calibrations</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="DBManager.exporter_excel-240"><a href="#DBManager.exporter_excel-240"><span class="linenos">240</span></a>
</span><span id="DBManager.exporter_excel-241"><a href="#DBManager.exporter_excel-241"><span class="linenos">241</span></a>            <span class="c1"># Nom de fichier avec date</span>
</span><span id="DBManager.exporter_excel-242"><a href="#DBManager.exporter_excel-242"><span class="linenos">242</span></a>            <span class="n">date_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="DBManager.exporter_excel-243"><a href="#DBManager.exporter_excel-243"><span class="linenos">243</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;export_capteurs_</span><span class="si">{</span><span class="n">date_str</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="DBManager.exporter_excel-244"><a href="#DBManager.exporter_excel-244"><span class="linenos">244</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DBManager.exporter_excel-245"><a href="#DBManager.exporter_excel-245"><span class="linenos">245</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Export réussi: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager.exporter_excel-246"><a href="#DBManager.exporter_excel-246"><span class="linenos">246</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.exporter_excel-247"><a href="#DBManager.exporter_excel-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Exporte les données avec filtres vers Excel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filtres</strong>:  Dictionnaire des filtres à appliquer (optionnel).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de l'export
           et un message de résultat.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.get_dernieres_calibrations" class="classattr">
                                        <input id="DBManager.get_dernieres_calibrations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dernieres_calibrations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DBManager.get_dernieres_calibrations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.get_dernieres_calibrations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.get_dernieres_calibrations-278"><a href="#DBManager.get_dernieres_calibrations-278"><span class="linenos">278</span></a>    <span class="k">def</span> <span class="nf">get_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager.get_dernieres_calibrations-279"><a href="#DBManager.get_dernieres_calibrations-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.get_dernieres_calibrations-280"><a href="#DBManager.get_dernieres_calibrations-280"><span class="linenos">280</span></a><span class="sd">        Récupère la dernière calibration pour chaque capteur.</span>
</span><span id="DBManager.get_dernieres_calibrations-281"><a href="#DBManager.get_dernieres_calibrations-281"><span class="linenos">281</span></a>
</span><span id="DBManager.get_dernieres_calibrations-282"><a href="#DBManager.get_dernieres_calibrations-282"><span class="linenos">282</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de la requête</span>
</span><span id="DBManager.get_dernieres_calibrations-283"><a href="#DBManager.get_dernieres_calibrations-283"><span class="linenos">283</span></a><span class="sd">                 et soit la liste des calibrations, soit un message d&#39;erreur.</span>
</span><span id="DBManager.get_dernieres_calibrations-284"><a href="#DBManager.get_dernieres_calibrations-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.get_dernieres_calibrations-285"><a href="#DBManager.get_dernieres_calibrations-285"><span class="linenos">285</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="DBManager.get_dernieres_calibrations-286"><a href="#DBManager.get_dernieres_calibrations-286"><span class="linenos">286</span></a><span class="s2">            WITH DernieresCalibs AS (</span>
</span><span id="DBManager.get_dernieres_calibrations-287"><a href="#DBManager.get_dernieres_calibrations-287"><span class="linenos">287</span></a><span class="s2">                SELECT </span>
</span><span id="DBManager.get_dernieres_calibrations-288"><a href="#DBManager.get_dernieres_calibrations-288"><span class="linenos">288</span></a><span class="s2">                    c.*,</span>
</span><span id="DBManager.get_dernieres_calibrations-289"><a href="#DBManager.get_dernieres_calibrations-289"><span class="linenos">289</span></a><span class="s2">                    ROW_NUMBER() OVER (</span>
</span><span id="DBManager.get_dernieres_calibrations-290"><a href="#DBManager.get_dernieres_calibrations-290"><span class="linenos">290</span></a><span class="s2">                        PARTITION BY nom_capteur </span>
</span><span id="DBManager.get_dernieres_calibrations-291"><a href="#DBManager.get_dernieres_calibrations-291"><span class="linenos">291</span></a><span class="s2">                        ORDER BY date_test DESC, id DESC</span>
</span><span id="DBManager.get_dernieres_calibrations-292"><a href="#DBManager.get_dernieres_calibrations-292"><span class="linenos">292</span></a><span class="s2">                    ) as rn</span>
</span><span id="DBManager.get_dernieres_calibrations-293"><a href="#DBManager.get_dernieres_calibrations-293"><span class="linenos">293</span></a><span class="s2">                FROM calibrations c</span>
</span><span id="DBManager.get_dernieres_calibrations-294"><a href="#DBManager.get_dernieres_calibrations-294"><span class="linenos">294</span></a><span class="s2">            )</span>
</span><span id="DBManager.get_dernieres_calibrations-295"><a href="#DBManager.get_dernieres_calibrations-295"><span class="linenos">295</span></a><span class="s2">            SELECT * FROM DernieresCalibs</span>
</span><span id="DBManager.get_dernieres_calibrations-296"><a href="#DBManager.get_dernieres_calibrations-296"><span class="linenos">296</span></a><span class="s2">            WHERE rn = 1</span>
</span><span id="DBManager.get_dernieres_calibrations-297"><a href="#DBManager.get_dernieres_calibrations-297"><span class="linenos">297</span></a><span class="s2">            ORDER BY nom_capteur</span>
</span><span id="DBManager.get_dernieres_calibrations-298"><a href="#DBManager.get_dernieres_calibrations-298"><span class="linenos">298</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="DBManager.get_dernieres_calibrations-299"><a href="#DBManager.get_dernieres_calibrations-299"><span class="linenos">299</span></a>
</span><span id="DBManager.get_dernieres_calibrations-300"><a href="#DBManager.get_dernieres_calibrations-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Récupère la dernière calibration pour chaque capteur.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de la requête
           et soit la liste des calibrations, soit un message d'erreur.</p>
</blockquote>
</div>


                            </div>
                            <div id="DBManager.exporter_dernieres_calibrations" class="classattr">
                                        <input id="DBManager.exporter_dernieres_calibrations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exporter_dernieres_calibrations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DBManager.exporter_dernieres_calibrations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DBManager.exporter_dernieres_calibrations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DBManager.exporter_dernieres_calibrations-302"><a href="#DBManager.exporter_dernieres_calibrations-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">exporter_dernieres_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DBManager.exporter_dernieres_calibrations-303"><a href="#DBManager.exporter_dernieres_calibrations-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-304"><a href="#DBManager.exporter_dernieres_calibrations-304"><span class="linenos">304</span></a><span class="sd">        Exporte les dernières calibrations pour chaque capteur dans un fichier Excel.</span>
</span><span id="DBManager.exporter_dernieres_calibrations-305"><a href="#DBManager.exporter_dernieres_calibrations-305"><span class="linenos">305</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-306"><a href="#DBManager.exporter_dernieres_calibrations-306"><span class="linenos">306</span></a><span class="sd">        :return: Un tuple contenant un booléen indiquant le succès de l&#39;export</span>
</span><span id="DBManager.exporter_dernieres_calibrations-307"><a href="#DBManager.exporter_dernieres_calibrations-307"><span class="linenos">307</span></a><span class="sd">                 et un message de résultat.</span>
</span><span id="DBManager.exporter_dernieres_calibrations-308"><a href="#DBManager.exporter_dernieres_calibrations-308"><span class="linenos">308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-309"><a href="#DBManager.exporter_dernieres_calibrations-309"><span class="linenos">309</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DBManager.exporter_dernieres_calibrations-310"><a href="#DBManager.exporter_dernieres_calibrations-310"><span class="linenos">310</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dernieres_calibrations</span><span class="p">()</span>
</span><span id="DBManager.exporter_dernieres_calibrations-311"><a href="#DBManager.exporter_dernieres_calibrations-311"><span class="linenos">311</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="DBManager.exporter_dernieres_calibrations-312"><a href="#DBManager.exporter_dernieres_calibrations-312"><span class="linenos">312</span></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Erreur lors de la récupération des dernières calibrations&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-313"><a href="#DBManager.exporter_dernieres_calibrations-313"><span class="linenos">313</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-314"><a href="#DBManager.exporter_dernieres_calibrations-314"><span class="linenos">314</span></a>            <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</span><span id="DBManager.exporter_dernieres_calibrations-315"><a href="#DBManager.exporter_dernieres_calibrations-315"><span class="linenos">315</span></a>            <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="DBManager.exporter_dernieres_calibrations-316"><a href="#DBManager.exporter_dernieres_calibrations-316"><span class="linenos">316</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Dernières Calibrations&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-317"><a href="#DBManager.exporter_dernieres_calibrations-317"><span class="linenos">317</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-318"><a href="#DBManager.exporter_dernieres_calibrations-318"><span class="linenos">318</span></a>            <span class="c1"># Ajouter les en-têtes</span>
</span><span id="DBManager.exporter_dernieres_calibrations-319"><a href="#DBManager.exporter_dernieres_calibrations-319"><span class="linenos">319</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="DBManager.exporter_dernieres_calibrations-320"><a href="#DBManager.exporter_dernieres_calibrations-320"><span class="linenos">320</span></a>                       <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span> <span class="s2">&quot;Coef Capt B&quot;</span><span class="p">]</span>
</span><span id="DBManager.exporter_dernieres_calibrations-321"><a href="#DBManager.exporter_dernieres_calibrations-321"><span class="linenos">321</span></a>            <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="DBManager.exporter_dernieres_calibrations-322"><a href="#DBManager.exporter_dernieres_calibrations-322"><span class="linenos">322</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-323"><a href="#DBManager.exporter_dernieres_calibrations-323"><span class="linenos">323</span></a>            <span class="c1"># Ajouter les données</span>
</span><span id="DBManager.exporter_dernieres_calibrations-324"><a href="#DBManager.exporter_dernieres_calibrations-324"><span class="linenos">324</span></a>            <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="DBManager.exporter_dernieres_calibrations-325"><a href="#DBManager.exporter_dernieres_calibrations-325"><span class="linenos">325</span></a>                <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>
</span><span id="DBManager.exporter_dernieres_calibrations-326"><a href="#DBManager.exporter_dernieres_calibrations-326"><span class="linenos">326</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-327"><a href="#DBManager.exporter_dernieres_calibrations-327"><span class="linenos">327</span></a>            <span class="c1"># Sauvegarde du fichier avec un horodatage unique</span>
</span><span id="DBManager.exporter_dernieres_calibrations-328"><a href="#DBManager.exporter_dernieres_calibrations-328"><span class="linenos">328</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dernieres_calibrations_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.xlsx&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-329"><a href="#DBManager.exporter_dernieres_calibrations-329"><span class="linenos">329</span></a>            <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DBManager.exporter_dernieres_calibrations-330"><a href="#DBManager.exporter_dernieres_calibrations-330"><span class="linenos">330</span></a>
</span><span id="DBManager.exporter_dernieres_calibrations-331"><a href="#DBManager.exporter_dernieres_calibrations-331"><span class="linenos">331</span></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Les dernières calibrations ont été exportées dans </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DBManager.exporter_dernieres_calibrations-332"><a href="#DBManager.exporter_dernieres_calibrations-332"><span class="linenos">332</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DBManager.exporter_dernieres_calibrations-333"><a href="#DBManager.exporter_dernieres_calibrations-333"><span class="linenos">333</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Erreur lors de l&#39;export: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Exporte les dernières calibrations pour chaque capteur dans un fichier Excel.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Un tuple contenant un booléen indiquant le succès de l'export
           et un message de résultat.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="GestionnaireFenetreDB">
                            <input id="GestionnaireFenetreDB-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GestionnaireFenetreDB</span>:

                <label class="view-source-button" for="GestionnaireFenetreDB-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GestionnaireFenetreDB"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GestionnaireFenetreDB-335"><a href="#GestionnaireFenetreDB-335"><span class="linenos">335</span></a><span class="k">class</span> <span class="nc">GestionnaireFenetreDB</span><span class="p">:</span>
</span><span id="GestionnaireFenetreDB-336"><a href="#GestionnaireFenetreDB-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GestionnaireFenetreDB-337"><a href="#GestionnaireFenetreDB-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GestionnaireFenetreDB-338"><a href="#GestionnaireFenetreDB-338"><span class="linenos">338</span></a>
</span><span id="GestionnaireFenetreDB-339"><a href="#GestionnaireFenetreDB-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">ouvrir_fenetre_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
</span><span id="GestionnaireFenetreDB-340"><a href="#GestionnaireFenetreDB-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ouvre la fenêtre de gestion de base de données si elle n&#39;existe pas déjà.&quot;&quot;&quot;</span>
</span><span id="GestionnaireFenetreDB-341"><a href="#GestionnaireFenetreDB-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">winfo_exists</span><span class="p">():</span>
</span><span id="GestionnaireFenetreDB-342"><a href="#GestionnaireFenetreDB-342"><span class="linenos">342</span></a>            <span class="c1"># Créer une nouvelle fenêtre</span>
</span><span id="GestionnaireFenetreDB-343"><a href="#GestionnaireFenetreDB-343"><span class="linenos">343</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-344"><a href="#GestionnaireFenetreDB-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gestion de la Base de Données&quot;</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-345"><a href="#GestionnaireFenetreDB-345"><span class="linenos">345</span></a>
</span><span id="GestionnaireFenetreDB-346"><a href="#GestionnaireFenetreDB-346"><span class="linenos">346</span></a>            <span class="c1"># Définir les dimensions</span>
</span><span id="GestionnaireFenetreDB-347"><a href="#GestionnaireFenetreDB-347"><span class="linenos">347</span></a>            <span class="n">window_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-348"><a href="#GestionnaireFenetreDB-348"><span class="linenos">348</span></a>            <span class="n">window_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-349"><a href="#GestionnaireFenetreDB-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">window_width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">window_height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-350"><a href="#GestionnaireFenetreDB-350"><span class="linenos">350</span></a>
</span><span id="GestionnaireFenetreDB-351"><a href="#GestionnaireFenetreDB-351"><span class="linenos">351</span></a>            <span class="c1"># Créer le notebook et les onglets</span>
</span><span id="GestionnaireFenetreDB-352"><a href="#GestionnaireFenetreDB-352"><span class="linenos">352</span></a>            <span class="n">notebook</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-353"><a href="#GestionnaireFenetreDB-353"><span class="linenos">353</span></a>            <span class="n">notebook</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-354"><a href="#GestionnaireFenetreDB-354"><span class="linenos">354</span></a>
</span><span id="GestionnaireFenetreDB-355"><a href="#GestionnaireFenetreDB-355"><span class="linenos">355</span></a>            <span class="c1"># Créer les onglets avec les fonctions existantes</span>
</span><span id="GestionnaireFenetreDB-356"><a href="#GestionnaireFenetreDB-356"><span class="linenos">356</span></a>            <span class="n">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-357"><a href="#GestionnaireFenetreDB-357"><span class="linenos">357</span></a>            <span class="n">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-358"><a href="#GestionnaireFenetreDB-358"><span class="linenos">358</span></a>
</span><span id="GestionnaireFenetreDB-359"><a href="#GestionnaireFenetreDB-359"><span class="linenos">359</span></a>            <span class="c1"># Assurer que la fenêtre reste au premier plan jusqu&#39;à sa fermeture</span>
</span><span id="GestionnaireFenetreDB-360"><a href="#GestionnaireFenetreDB-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-361"><a href="#GestionnaireFenetreDB-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB-362"><a href="#GestionnaireFenetreDB-362"><span class="linenos">362</span></a>
</span><span id="GestionnaireFenetreDB-363"><a href="#GestionnaireFenetreDB-363"><span class="linenos">363</span></a>            <span class="c1"># Gérer la fermeture propre</span>
</span><span id="GestionnaireFenetreDB-364"><a href="#GestionnaireFenetreDB-364"><span class="linenos">364</span></a>            <span class="k">def</span> <span class="nf">on_closing</span><span class="p">():</span>
</span><span id="GestionnaireFenetreDB-365"><a href="#GestionnaireFenetreDB-365"><span class="linenos">365</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_release</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB-366"><a href="#GestionnaireFenetreDB-366"><span class="linenos">366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB-367"><a href="#GestionnaireFenetreDB-367"><span class="linenos">367</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GestionnaireFenetreDB-368"><a href="#GestionnaireFenetreDB-368"><span class="linenos">368</span></a>
</span><span id="GestionnaireFenetreDB-369"><a href="#GestionnaireFenetreDB-369"><span class="linenos">369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="n">on_closing</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB-370"><a href="#GestionnaireFenetreDB-370"><span class="linenos">370</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GestionnaireFenetreDB-371"><a href="#GestionnaireFenetreDB-371"><span class="linenos">371</span></a>            <span class="c1"># Si la fenêtre existe déjà, la mettre au premier plan</span>
</span><span id="GestionnaireFenetreDB-372"><a href="#GestionnaireFenetreDB-372"><span class="linenos">372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB-373"><a href="#GestionnaireFenetreDB-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">focus_force</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="GestionnaireFenetreDB.fenetre_db" class="classattr">
                                <div class="attr variable">
            <span class="name">fenetre_db</span>

        
    </div>
    <a class="headerlink" href="#GestionnaireFenetreDB.fenetre_db"></a>
    
    

                            </div>
                            <div id="GestionnaireFenetreDB.ouvrir_fenetre_db" class="classattr">
                                        <input id="GestionnaireFenetreDB.ouvrir_fenetre_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ouvrir_fenetre_db</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">parent</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GestionnaireFenetreDB.ouvrir_fenetre_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GestionnaireFenetreDB.ouvrir_fenetre_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-339"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">ouvrir_fenetre_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-340"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ouvre la fenêtre de gestion de base de données si elle n&#39;existe pas déjà.&quot;&quot;&quot;</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-341"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">winfo_exists</span><span class="p">():</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-342"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-342"><span class="linenos">342</span></a>            <span class="c1"># Créer une nouvelle fenêtre</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-343"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-343"><span class="linenos">343</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-344"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gestion de la Base de Données&quot;</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-345"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-345"><span class="linenos">345</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-346"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-346"><span class="linenos">346</span></a>            <span class="c1"># Définir les dimensions</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-347"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-347"><span class="linenos">347</span></a>            <span class="n">window_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-348"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-348"><span class="linenos">348</span></a>            <span class="n">window_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-349"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">window_width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">window_height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-350"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-350"><span class="linenos">350</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-351"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-351"><span class="linenos">351</span></a>            <span class="c1"># Créer le notebook et les onglets</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-352"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-352"><span class="linenos">352</span></a>            <span class="n">notebook</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-353"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-353"><span class="linenos">353</span></a>            <span class="n">notebook</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-354"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-354"><span class="linenos">354</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-355"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-355"><span class="linenos">355</span></a>            <span class="c1"># Créer les onglets avec les fonctions existantes</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-356"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-356"><span class="linenos">356</span></a>            <span class="n">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-357"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-357"><span class="linenos">357</span></a>            <span class="n">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-358"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-358"><span class="linenos">358</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-359"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-359"><span class="linenos">359</span></a>            <span class="c1"># Assurer que la fenêtre reste au premier plan jusqu&#39;à sa fermeture</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-360"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-361"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-362"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-362"><span class="linenos">362</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-363"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-363"><span class="linenos">363</span></a>            <span class="c1"># Gérer la fermeture propre</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-364"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-364"><span class="linenos">364</span></a>            <span class="k">def</span> <span class="nf">on_closing</span><span class="p">():</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-365"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-365"><span class="linenos">365</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">grab_release</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-366"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-366"><span class="linenos">366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-367"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-367"><span class="linenos">367</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-368"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-368"><span class="linenos">368</span></a>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-369"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-369"><span class="linenos">369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="n">on_closing</span><span class="p">)</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-370"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-370"><span class="linenos">370</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-371"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-371"><span class="linenos">371</span></a>            <span class="c1"># Si la fenêtre existe déjà, la mettre au premier plan</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-372"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-372"><span class="linenos">372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
</span><span id="GestionnaireFenetreDB.ouvrir_fenetre_db-373"><a href="#GestionnaireFenetreDB.ouvrir_fenetre_db-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fenetre_db</span><span class="o">.</span><span class="n">focus_force</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Ouvre la fenêtre de gestion de base de données si elle n'existe pas déjà.</p>
</div>


                            </div>
                </section>
                <section id="creer_onglet_base_de_donnees">
                            <input id="creer_onglet_base_de_donnees-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">creer_onglet_base_de_donnees</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">notebook</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="creer_onglet_base_de_donnees-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#creer_onglet_base_de_donnees"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="creer_onglet_base_de_donnees-375"><a href="#creer_onglet_base_de_donnees-375"><span class="linenos">375</span></a><span class="k">def</span> <span class="nf">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">):</span>
</span><span id="creer_onglet_base_de_donnees-376"><a href="#creer_onglet_base_de_donnees-376"><span class="linenos">376</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée l&#39;onglet Base de données avec filtres et tri.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-377"><a href="#creer_onglet_base_de_donnees-377"><span class="linenos">377</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-378"><a href="#creer_onglet_base_de_donnees-378"><span class="linenos">378</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Base de données&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-379"><a href="#creer_onglet_base_de_donnees-379"><span class="linenos">379</span></a>
</span><span id="creer_onglet_base_de_donnees-380"><a href="#creer_onglet_base_de_donnees-380"><span class="linenos">380</span></a>    <span class="c1"># Frame pour les filtres</span>
</span><span id="creer_onglet_base_de_donnees-381"><a href="#creer_onglet_base_de_donnees-381"><span class="linenos">381</span></a>    <span class="n">frame_filtres</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filtres&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-382"><a href="#creer_onglet_base_de_donnees-382"><span class="linenos">382</span></a>    <span class="n">frame_filtres</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-383"><a href="#creer_onglet_base_de_donnees-383"><span class="linenos">383</span></a>
</span><span id="creer_onglet_base_de_donnees-384"><a href="#creer_onglet_base_de_donnees-384"><span class="linenos">384</span></a>    <span class="c1"># Frame pour les TreeViews</span>
</span><span id="creer_onglet_base_de_donnees-385"><a href="#creer_onglet_base_de_donnees-385"><span class="linenos">385</span></a>    <span class="n">frame_data</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-386"><a href="#creer_onglet_base_de_donnees-386"><span class="linenos">386</span></a>    <span class="n">frame_data</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-387"><a href="#creer_onglet_base_de_donnees-387"><span class="linenos">387</span></a>
</span><span id="creer_onglet_base_de_donnees-388"><a href="#creer_onglet_base_de_donnees-388"><span class="linenos">388</span></a>    <span class="c1"># Création du PanedWindow pour les TreeViews</span>
</span><span id="creer_onglet_base_de_donnees-389"><a href="#creer_onglet_base_de_donnees-389"><span class="linenos">389</span></a>    <span class="n">paned</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">PanedWindow</span><span class="p">(</span><span class="n">frame_data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-390"><a href="#creer_onglet_base_de_donnees-390"><span class="linenos">390</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-391"><a href="#creer_onglet_base_de_donnees-391"><span class="linenos">391</span></a>
</span><span id="creer_onglet_base_de_donnees-392"><a href="#creer_onglet_base_de_donnees-392"><span class="linenos">392</span></a>    <span class="c1"># Création des TreeViews</span>
</span><span id="creer_onglet_base_de_donnees-393"><a href="#creer_onglet_base_de_donnees-393"><span class="linenos">393</span></a>    <span class="n">tree_calibrations</span> <span class="o">=</span> <span class="n">creer_treeview_calibrations</span><span class="p">(</span><span class="n">paned</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-394"><a href="#creer_onglet_base_de_donnees-394"><span class="linenos">394</span></a>    <span class="n">tree_paliers</span> <span class="o">=</span> <span class="n">creer_treeview_paliers</span><span class="p">(</span><span class="n">paned</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-395"><a href="#creer_onglet_base_de_donnees-395"><span class="linenos">395</span></a>
</span><span id="creer_onglet_base_de_donnees-396"><a href="#creer_onglet_base_de_donnees-396"><span class="linenos">396</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree_calibrations</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-397"><a href="#creer_onglet_base_de_donnees-397"><span class="linenos">397</span></a>    <span class="n">paned</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree_paliers</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-398"><a href="#creer_onglet_base_de_donnees-398"><span class="linenos">398</span></a>
</span><span id="creer_onglet_base_de_donnees-399"><a href="#creer_onglet_base_de_donnees-399"><span class="linenos">399</span></a>    <span class="c1"># Variables pour les filtres</span>
</span><span id="creer_onglet_base_de_donnees-400"><a href="#creer_onglet_base_de_donnees-400"><span class="linenos">400</span></a>    <span class="n">filtres</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="creer_onglet_base_de_donnees-401"><a href="#creer_onglet_base_de_donnees-401"><span class="linenos">401</span></a>        <span class="s1">&#39;capteur&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(),</span>
</span><span id="creer_onglet_base_de_donnees-402"><a href="#creer_onglet_base_de_donnees-402"><span class="linenos">402</span></a>        <span class="s1">&#39;annee&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(),</span>
</span><span id="creer_onglet_base_de_donnees-403"><a href="#creer_onglet_base_de_donnees-403"><span class="linenos">403</span></a>        <span class="s1">&#39;operateur&#39;</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-404"><a href="#creer_onglet_base_de_donnees-404"><span class="linenos">404</span></a>    <span class="p">}</span>
</span><span id="creer_onglet_base_de_donnees-405"><a href="#creer_onglet_base_de_donnees-405"><span class="linenos">405</span></a>
</span><span id="creer_onglet_base_de_donnees-406"><a href="#creer_onglet_base_de_donnees-406"><span class="linenos">406</span></a>    <span class="c1"># Création des widgets de filtres</span>
</span><span id="creer_onglet_base_de_donnees-407"><a href="#creer_onglet_base_de_donnees-407"><span class="linenos">407</span></a>    <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="creer_onglet_base_de_donnees-408"><a href="#creer_onglet_base_de_donnees-408"><span class="linenos">408</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Capteur:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-409"><a href="#creer_onglet_base_de_donnees-409"><span class="linenos">409</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-410"><a href="#creer_onglet_base_de_donnees-410"><span class="linenos">410</span></a>
</span><span id="creer_onglet_base_de_donnees-411"><a href="#creer_onglet_base_de_donnees-411"><span class="linenos">411</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Année:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-412"><a href="#creer_onglet_base_de_donnees-412"><span class="linenos">412</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-413"><a href="#creer_onglet_base_de_donnees-413"><span class="linenos">413</span></a>
</span><span id="creer_onglet_base_de_donnees-414"><a href="#creer_onglet_base_de_donnees-414"><span class="linenos">414</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Opérateur:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-415"><a href="#creer_onglet_base_de_donnees-415"><span class="linenos">415</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-416"><a href="#creer_onglet_base_de_donnees-416"><span class="linenos">416</span></a>
</span><span id="creer_onglet_base_de_donnees-417"><a href="#creer_onglet_base_de_donnees-417"><span class="linenos">417</span></a>    <span class="k">def</span> <span class="nf">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">calibrations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="creer_onglet_base_de_donnees-418"><a href="#creer_onglet_base_de_donnees-418"><span class="linenos">418</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Met à jour l&#39;affichage des TreeViews avec les données filtrées.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-419"><a href="#creer_onglet_base_de_donnees-419"><span class="linenos">419</span></a>        <span class="c1"># Effacer les données existantes</span>
</span><span id="creer_onglet_base_de_donnees-420"><a href="#creer_onglet_base_de_donnees-420"><span class="linenos">420</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-421"><a href="#creer_onglet_base_de_donnees-421"><span class="linenos">421</span></a>            <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-422"><a href="#creer_onglet_base_de_donnees-422"><span class="linenos">422</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-423"><a href="#creer_onglet_base_de_donnees-423"><span class="linenos">423</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-424"><a href="#creer_onglet_base_de_donnees-424"><span class="linenos">424</span></a>
</span><span id="creer_onglet_base_de_donnees-425"><a href="#creer_onglet_base_de_donnees-425"><span class="linenos">425</span></a>        <span class="c1"># Si aucune donnée n&#39;est fournie, récupérer toutes les calibrations</span>
</span><span id="creer_onglet_base_de_donnees-426"><a href="#creer_onglet_base_de_donnees-426"><span class="linenos">426</span></a>        <span class="k">if</span> <span class="n">calibrations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-427"><a href="#creer_onglet_base_de_donnees-427"><span class="linenos">427</span></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-428"><a href="#creer_onglet_base_de_donnees-428"><span class="linenos">428</span></a>            <span class="n">calibrations</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-429"><a href="#creer_onglet_base_de_donnees-429"><span class="linenos">429</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-430"><a href="#creer_onglet_base_de_donnees-430"><span class="linenos">430</span></a>
</span><span id="creer_onglet_base_de_donnees-431"><a href="#creer_onglet_base_de_donnees-431"><span class="linenos">431</span></a>        <span class="c1"># Insérer les nouvelles données</span>
</span><span id="creer_onglet_base_de_donnees-432"><a href="#creer_onglet_base_de_donnees-432"><span class="linenos">432</span></a>        <span class="k">for</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">calibrations</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-433"><a href="#creer_onglet_base_de_donnees-433"><span class="linenos">433</span></a>            <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">cal</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-434"><a href="#creer_onglet_base_de_donnees-434"><span class="linenos">434</span></a>
</span><span id="creer_onglet_base_de_donnees-435"><a href="#creer_onglet_base_de_donnees-435"><span class="linenos">435</span></a>    <span class="k">def</span> <span class="nf">appliquer_filtres</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-436"><a href="#creer_onglet_base_de_donnees-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applique les filtres sélectionnés.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-437"><a href="#creer_onglet_base_de_donnees-437"><span class="linenos">437</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-438"><a href="#creer_onglet_base_de_donnees-438"><span class="linenos">438</span></a>        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="creer_onglet_base_de_donnees-439"><a href="#creer_onglet_base_de_donnees-439"><span class="linenos">439</span></a>
</span><span id="creer_onglet_base_de_donnees-440"><a href="#creer_onglet_base_de_donnees-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-441"><a href="#creer_onglet_base_de_donnees-441"><span class="linenos">441</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;nom_capteur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-442"><a href="#creer_onglet_base_de_donnees-442"><span class="linenos">442</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-443"><a href="#creer_onglet_base_de_donnees-443"><span class="linenos">443</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;strftime(&quot;%Y&quot;, date_test)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-444"><a href="#creer_onglet_base_de_donnees-444"><span class="linenos">444</span></a>        <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-445"><a href="#creer_onglet_base_de_donnees-445"><span class="linenos">445</span></a>            <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-446"><a href="#creer_onglet_base_de_donnees-446"><span class="linenos">446</span></a>
</span><span id="creer_onglet_base_de_donnees-447"><a href="#creer_onglet_base_de_donnees-447"><span class="linenos">447</span></a>        <span class="n">calibrations</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_calibrations</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-448"><a href="#creer_onglet_base_de_donnees-448"><span class="linenos">448</span></a>        <span class="n">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">calibrations</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-449"><a href="#creer_onglet_base_de_donnees-449"><span class="linenos">449</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-450"><a href="#creer_onglet_base_de_donnees-450"><span class="linenos">450</span></a>
</span><span id="creer_onglet_base_de_donnees-451"><a href="#creer_onglet_base_de_donnees-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">on_calibration_select</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="creer_onglet_base_de_donnees-452"><a href="#creer_onglet_base_de_donnees-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gère la sélection d&#39;une ou plusieurs calibrations.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-453"><a href="#creer_onglet_base_de_donnees-453"><span class="linenos">453</span></a>        <span class="c1"># Effacer les paliers existants</span>
</span><span id="creer_onglet_base_de_donnees-454"><a href="#creer_onglet_base_de_donnees-454"><span class="linenos">454</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-455"><a href="#creer_onglet_base_de_donnees-455"><span class="linenos">455</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-456"><a href="#creer_onglet_base_de_donnees-456"><span class="linenos">456</span></a>
</span><span id="creer_onglet_base_de_donnees-457"><a href="#creer_onglet_base_de_donnees-457"><span class="linenos">457</span></a>        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-458"><a href="#creer_onglet_base_de_donnees-458"><span class="linenos">458</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Si une seule calibration est sélectionnée</span>
</span><span id="creer_onglet_base_de_donnees-459"><a href="#creer_onglet_base_de_donnees-459"><span class="linenos">459</span></a>            <span class="n">item</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="creer_onglet_base_de_donnees-460"><a href="#creer_onglet_base_de_donnees-460"><span class="linenos">460</span></a>            <span class="n">calibration_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="creer_onglet_base_de_donnees-461"><a href="#creer_onglet_base_de_donnees-461"><span class="linenos">461</span></a>
</span><span id="creer_onglet_base_de_donnees-462"><a href="#creer_onglet_base_de_donnees-462"><span class="linenos">462</span></a>            <span class="c1"># Charger les paliers pour cette calibration</span>
</span><span id="creer_onglet_base_de_donnees-463"><a href="#creer_onglet_base_de_donnees-463"><span class="linenos">463</span></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-464"><a href="#creer_onglet_base_de_donnees-464"><span class="linenos">464</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">paliers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
</span><span id="creer_onglet_base_de_donnees-465"><a href="#creer_onglet_base_de_donnees-465"><span class="linenos">465</span></a>                <span class="s2">&quot;SELECT * FROM paliers WHERE calibration_id = ? ORDER BY numero_palier&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-466"><a href="#creer_onglet_base_de_donnees-466"><span class="linenos">466</span></a>                <span class="p">(</span><span class="n">calibration_id</span><span class="p">,)</span>
</span><span id="creer_onglet_base_de_donnees-467"><a href="#creer_onglet_base_de_donnees-467"><span class="linenos">467</span></a>            <span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-468"><a href="#creer_onglet_base_de_donnees-468"><span class="linenos">468</span></a>            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-469"><a href="#creer_onglet_base_de_donnees-469"><span class="linenos">469</span></a>                <span class="k">for</span> <span class="n">palier</span> <span class="ow">in</span> <span class="n">paliers</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-470"><a href="#creer_onglet_base_de_donnees-470"><span class="linenos">470</span></a>                    <span class="n">tree_paliers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">palier</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-471"><a href="#creer_onglet_base_de_donnees-471"><span class="linenos">471</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-472"><a href="#creer_onglet_base_de_donnees-472"><span class="linenos">472</span></a>
</span><span id="creer_onglet_base_de_donnees-473"><a href="#creer_onglet_base_de_donnees-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">afficher_dernieres_calibrations</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-474"><a href="#creer_onglet_base_de_donnees-474"><span class="linenos">474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Affiche uniquement la dernière calibration de chaque capteur.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-475"><a href="#creer_onglet_base_de_donnees-475"><span class="linenos">475</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-476"><a href="#creer_onglet_base_de_donnees-476"><span class="linenos">476</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_dernieres_calibrations</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-477"><a href="#creer_onglet_base_de_donnees-477"><span class="linenos">477</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-478"><a href="#creer_onglet_base_de_donnees-478"><span class="linenos">478</span></a>
</span><span id="creer_onglet_base_de_donnees-479"><a href="#creer_onglet_base_de_donnees-479"><span class="linenos">479</span></a>        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-480"><a href="#creer_onglet_base_de_donnees-480"><span class="linenos">480</span></a>            <span class="n">mettre_a_jour_affichage</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-481"><a href="#creer_onglet_base_de_donnees-481"><span class="linenos">481</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-482"><a href="#creer_onglet_base_de_donnees-482"><span class="linenos">482</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="s2">&quot;Impossible de récupérer les dernières calibrations&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-483"><a href="#creer_onglet_base_de_donnees-483"><span class="linenos">483</span></a>
</span><span id="creer_onglet_base_de_donnees-484"><a href="#creer_onglet_base_de_donnees-484"><span class="linenos">484</span></a>    <span class="c1"># Liaison des événements</span>
</span><span id="creer_onglet_base_de_donnees-485"><a href="#creer_onglet_base_de_donnees-485"><span class="linenos">485</span></a>    <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;TreeviewSelect&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">on_calibration_select</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-486"><a href="#creer_onglet_base_de_donnees-486"><span class="linenos">486</span></a>
</span><span id="creer_onglet_base_de_donnees-487"><a href="#creer_onglet_base_de_donnees-487"><span class="linenos">487</span></a>    <span class="c1"># Boutons d&#39;action</span>
</span><span id="creer_onglet_base_de_donnees-488"><a href="#creer_onglet_base_de_donnees-488"><span class="linenos">488</span></a>    <span class="n">frame_boutons</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame_filtres</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-489"><a href="#creer_onglet_base_de_donnees-489"><span class="linenos">489</span></a>    <span class="n">frame_boutons</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-490"><a href="#creer_onglet_base_de_donnees-490"><span class="linenos">490</span></a>
</span><span id="creer_onglet_base_de_donnees-491"><a href="#creer_onglet_base_de_donnees-491"><span class="linenos">491</span></a>    <span class="k">def</span> <span class="nf">supprimer_calibrations_selectionnees</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-492"><a href="#creer_onglet_base_de_donnees-492"><span class="linenos">492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Supprime toutes les calibrations sélectionnées après confirmation.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_base_de_donnees-493"><a href="#creer_onglet_base_de_donnees-493"><span class="linenos">493</span></a>        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-494"><a href="#creer_onglet_base_de_donnees-494"><span class="linenos">494</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">selection</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-495"><a href="#creer_onglet_base_de_donnees-495"><span class="linenos">495</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Avertissement&quot;</span><span class="p">,</span> <span class="s2">&quot;Veuillez sélectionner au moins une calibration à supprimer.&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-496"><a href="#creer_onglet_base_de_donnees-496"><span class="linenos">496</span></a>            <span class="k">return</span>
</span><span id="creer_onglet_base_de_donnees-497"><a href="#creer_onglet_base_de_donnees-497"><span class="linenos">497</span></a>
</span><span id="creer_onglet_base_de_donnees-498"><a href="#creer_onglet_base_de_donnees-498"><span class="linenos">498</span></a>        <span class="n">nb_selections</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-499"><a href="#creer_onglet_base_de_donnees-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askyesno</span><span class="p">(</span><span class="s2">&quot;Confirmation&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-500"><a href="#creer_onglet_base_de_donnees-500"><span class="linenos">500</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Êtes-vous sûr de vouloir supprimer ces </span><span class="si">{</span><span class="n">nb_selections</span><span class="si">}</span><span class="s2"> calibration(s) et tous leurs paliers associés ?&quot;</span><span class="p">):</span>
</span><span id="creer_onglet_base_de_donnees-501"><a href="#creer_onglet_base_de_donnees-501"><span class="linenos">501</span></a>            <span class="k">return</span>
</span><span id="creer_onglet_base_de_donnees-502"><a href="#creer_onglet_base_de_donnees-502"><span class="linenos">502</span></a>
</span><span id="creer_onglet_base_de_donnees-503"><a href="#creer_onglet_base_de_donnees-503"><span class="linenos">503</span></a>        <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-504"><a href="#creer_onglet_base_de_donnees-504"><span class="linenos">504</span></a>        <span class="c1">#db.afficher_liste_capteurs_uniques(notebook)</span>
</span><span id="creer_onglet_base_de_donnees-505"><a href="#creer_onglet_base_de_donnees-505"><span class="linenos">505</span></a>        <span class="n">erreurs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="creer_onglet_base_de_donnees-506"><a href="#creer_onglet_base_de_donnees-506"><span class="linenos">506</span></a>        <span class="n">supprimees</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="creer_onglet_base_de_donnees-507"><a href="#creer_onglet_base_de_donnees-507"><span class="linenos">507</span></a>
</span><span id="creer_onglet_base_de_donnees-508"><a href="#creer_onglet_base_de_donnees-508"><span class="linenos">508</span></a>        <span class="k">for</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-509"><a href="#creer_onglet_base_de_donnees-509"><span class="linenos">509</span></a>            <span class="n">item</span> <span class="o">=</span> <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-510"><a href="#creer_onglet_base_de_donnees-510"><span class="linenos">510</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-511"><a href="#creer_onglet_base_de_donnees-511"><span class="linenos">511</span></a>                <span class="n">calibration_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="creer_onglet_base_de_donnees-512"><a href="#creer_onglet_base_de_donnees-512"><span class="linenos">512</span></a>                <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">supprimer_calibration</span><span class="p">(</span><span class="n">calibration_id</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-513"><a href="#creer_onglet_base_de_donnees-513"><span class="linenos">513</span></a>
</span><span id="creer_onglet_base_de_donnees-514"><a href="#creer_onglet_base_de_donnees-514"><span class="linenos">514</span></a>                <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-515"><a href="#creer_onglet_base_de_donnees-515"><span class="linenos">515</span></a>                    <span class="n">tree_calibrations</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-516"><a href="#creer_onglet_base_de_donnees-516"><span class="linenos">516</span></a>                    <span class="n">supprimees</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="creer_onglet_base_de_donnees-517"><a href="#creer_onglet_base_de_donnees-517"><span class="linenos">517</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-518"><a href="#creer_onglet_base_de_donnees-518"><span class="linenos">518</span></a>                    <span class="n">erreurs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calibration </span><span class="si">{</span><span class="n">calibration_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-519"><a href="#creer_onglet_base_de_donnees-519"><span class="linenos">519</span></a>
</span><span id="creer_onglet_base_de_donnees-520"><a href="#creer_onglet_base_de_donnees-520"><span class="linenos">520</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-521"><a href="#creer_onglet_base_de_donnees-521"><span class="linenos">521</span></a>                <span class="n">erreurs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur avec l&#39;item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-522"><a href="#creer_onglet_base_de_donnees-522"><span class="linenos">522</span></a>
</span><span id="creer_onglet_base_de_donnees-523"><a href="#creer_onglet_base_de_donnees-523"><span class="linenos">523</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-524"><a href="#creer_onglet_base_de_donnees-524"><span class="linenos">524</span></a>
</span><span id="creer_onglet_base_de_donnees-525"><a href="#creer_onglet_base_de_donnees-525"><span class="linenos">525</span></a>        <span class="c1"># Effacer les paliers affichés</span>
</span><span id="creer_onglet_base_de_donnees-526"><a href="#creer_onglet_base_de_donnees-526"><span class="linenos">526</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree_paliers</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
</span><span id="creer_onglet_base_de_donnees-527"><a href="#creer_onglet_base_de_donnees-527"><span class="linenos">527</span></a>            <span class="n">tree_paliers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-528"><a href="#creer_onglet_base_de_donnees-528"><span class="linenos">528</span></a>
</span><span id="creer_onglet_base_de_donnees-529"><a href="#creer_onglet_base_de_donnees-529"><span class="linenos">529</span></a>        <span class="c1"># Afficher le résultat</span>
</span><span id="creer_onglet_base_de_donnees-530"><a href="#creer_onglet_base_de_donnees-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="n">supprimees</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-531"><a href="#creer_onglet_base_de_donnees-531"><span class="linenos">531</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">supprimees</span><span class="si">}</span><span class="s2"> calibration(s) supprimée(s) avec succès.&quot;</span>
</span><span id="creer_onglet_base_de_donnees-532"><a href="#creer_onglet_base_de_donnees-532"><span class="linenos">532</span></a>            <span class="k">if</span> <span class="n">erreurs</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-533"><a href="#creer_onglet_base_de_donnees-533"><span class="linenos">533</span></a>                <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Erreurs rencontrées :</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">erreurs</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-534"><a href="#creer_onglet_base_de_donnees-534"><span class="linenos">534</span></a>
</span><span id="creer_onglet_base_de_donnees-535"><a href="#creer_onglet_base_de_donnees-535"><span class="linenos">535</span></a>            <span class="k">if</span> <span class="n">erreurs</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-536"><a href="#creer_onglet_base_de_donnees-536"><span class="linenos">536</span></a>                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Résultat&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-537"><a href="#creer_onglet_base_de_donnees-537"><span class="linenos">537</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-538"><a href="#creer_onglet_base_de_donnees-538"><span class="linenos">538</span></a>                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Succès&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-539"><a href="#creer_onglet_base_de_donnees-539"><span class="linenos">539</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="creer_onglet_base_de_donnees-540"><a href="#creer_onglet_base_de_donnees-540"><span class="linenos">540</span></a>            <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="s2">&quot;Aucune suppression effectuée.</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">erreurs</span><span class="p">))</span>
</span><span id="creer_onglet_base_de_donnees-541"><a href="#creer_onglet_base_de_donnees-541"><span class="linenos">541</span></a>
</span><span id="creer_onglet_base_de_donnees-542"><a href="#creer_onglet_base_de_donnees-542"><span class="linenos">542</span></a>    <span class="c1"># Ajouter le bouton de suppression</span>
</span><span id="creer_onglet_base_de_donnees-543"><a href="#creer_onglet_base_de_donnees-543"><span class="linenos">543</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-544"><a href="#creer_onglet_base_de_donnees-544"><span class="linenos">544</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Supprimer sélection&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-545"><a href="#creer_onglet_base_de_donnees-545"><span class="linenos">545</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">supprimer_calibrations_selectionnees</span>
</span><span id="creer_onglet_base_de_donnees-546"><a href="#creer_onglet_base_de_donnees-546"><span class="linenos">546</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-547"><a href="#creer_onglet_base_de_donnees-547"><span class="linenos">547</span></a>
</span><span id="creer_onglet_base_de_donnees-548"><a href="#creer_onglet_base_de_donnees-548"><span class="linenos">548</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Appliquer filtres&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-549"><a href="#creer_onglet_base_de_donnees-549"><span class="linenos">549</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">appliquer_filtres</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-550"><a href="#creer_onglet_base_de_donnees-550"><span class="linenos">550</span></a>
</span><span id="creer_onglet_base_de_donnees-551"><a href="#creer_onglet_base_de_donnees-551"><span class="linenos">551</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Réinitialiser filtres&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-552"><a href="#creer_onglet_base_de_donnees-552"><span class="linenos">552</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">filtres</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="n">mettre_a_jour_affichage</span><span class="p">()])</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span>
</span><span id="creer_onglet_base_de_donnees-553"><a href="#creer_onglet_base_de_donnees-553"><span class="linenos">553</span></a>        <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-554"><a href="#creer_onglet_base_de_donnees-554"><span class="linenos">554</span></a>
</span><span id="creer_onglet_base_de_donnees-555"><a href="#creer_onglet_base_de_donnees-555"><span class="linenos">555</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exporter filtrés ou liste complete&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-556"><a href="#creer_onglet_base_de_donnees-556"><span class="linenos">556</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">exporter_donnees_filtrees</span><span class="p">(</span><span class="n">filtres</span><span class="p">))</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-557"><a href="#creer_onglet_base_de_donnees-557"><span class="linenos">557</span></a>
</span><span id="creer_onglet_base_de_donnees-558"><a href="#creer_onglet_base_de_donnees-558"><span class="linenos">558</span></a>    <span class="c1"># Ajout du bouton afficher_dernieres_calibrations dans l&#39;interface</span>
</span><span id="creer_onglet_base_de_donnees-559"><a href="#creer_onglet_base_de_donnees-559"><span class="linenos">559</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-560"><a href="#creer_onglet_base_de_donnees-560"><span class="linenos">560</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dernières calibrations&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-561"><a href="#creer_onglet_base_de_donnees-561"><span class="linenos">561</span></a>               <span class="n">command</span><span class="o">=</span><span class="n">afficher_dernieres_calibrations</span>
</span><span id="creer_onglet_base_de_donnees-562"><a href="#creer_onglet_base_de_donnees-562"><span class="linenos">562</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-563"><a href="#creer_onglet_base_de_donnees-563"><span class="linenos">563</span></a>    <span class="c1"># Ajout du bouton exporter_dernieres_calibrations dans l&#39;interface</span>
</span><span id="creer_onglet_base_de_donnees-564"><a href="#creer_onglet_base_de_donnees-564"><span class="linenos">564</span></a>    <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame_boutons</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-565"><a href="#creer_onglet_base_de_donnees-565"><span class="linenos">565</span></a>               <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exporter dernières calibrations&quot;</span><span class="p">,</span>
</span><span id="creer_onglet_base_de_donnees-566"><a href="#creer_onglet_base_de_donnees-566"><span class="linenos">566</span></a>               <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">exporter_dernieres_calibrations_db</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-567"><a href="#creer_onglet_base_de_donnees-567"><span class="linenos">567</span></a>               <span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="creer_onglet_base_de_donnees-568"><a href="#creer_onglet_base_de_donnees-568"><span class="linenos">568</span></a>
</span><span id="creer_onglet_base_de_donnees-569"><a href="#creer_onglet_base_de_donnees-569"><span class="linenos">569</span></a>    <span class="c1"># Chargement initial des données</span>
</span><span id="creer_onglet_base_de_donnees-570"><a href="#creer_onglet_base_de_donnees-570"><span class="linenos">570</span></a>    <span class="n">mettre_a_jour_affichage</span><span class="p">()</span>
</span><span id="creer_onglet_base_de_donnees-571"><a href="#creer_onglet_base_de_donnees-571"><span class="linenos">571</span></a>
</span><span id="creer_onglet_base_de_donnees-572"><a href="#creer_onglet_base_de_donnees-572"><span class="linenos">572</span></a>    <span class="k">return</span> <span class="n">frame</span>
</span></pre></div>


            <div class="docstring"><p>Crée l'onglet Base de données avec filtres et tri.</p>
</div>


                </section>
                <section id="creer_onglet_deux">
                            <input id="creer_onglet_deux-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">creer_onglet_deux</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">notebook</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="creer_onglet_deux-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#creer_onglet_deux"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="creer_onglet_deux-574"><a href="#creer_onglet_deux-574"><span class="linenos">574</span></a><span class="k">def</span> <span class="nf">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">):</span>
</span><span id="creer_onglet_deux-575"><a href="#creer_onglet_deux-575"><span class="linenos">575</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée le 2e onglet  dans le notebook.&quot;&quot;&quot;</span>
</span><span id="creer_onglet_deux-576"><a href="#creer_onglet_deux-576"><span class="linenos">576</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="creer_onglet_deux-577"><a href="#creer_onglet_deux-577"><span class="linenos">577</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;EnCours&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_deux-578"><a href="#creer_onglet_deux-578"><span class="linenos">578</span></a>    <span class="c1"># Ajout de contenu dans frame_2 (exemple)</span>
</span><span id="creer_onglet_deux-579"><a href="#creer_onglet_deux-579"><span class="linenos">579</span></a>    <span class="n">label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Contenu de l&#39;onglet &#39;EnCours&#39; options pour plus tard&quot;</span><span class="p">)</span>
</span><span id="creer_onglet_deux-580"><a href="#creer_onglet_deux-580"><span class="linenos">580</span></a>    <span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="creer_onglet_deux-581"><a href="#creer_onglet_deux-581"><span class="linenos">581</span></a>    <span class="n">bouton</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cliquez-moi&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">Nan</span><span class="p">)</span>
</span><span id="creer_onglet_deux-582"><a href="#creer_onglet_deux-582"><span class="linenos">582</span></a>    <span class="n">bouton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Crée le 2e onglet  dans le notebook.</p>
</div>


                </section>
                <section id="creer_treeview_calibrations">
                            <input id="creer_treeview_calibrations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">creer_treeview_calibrations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="creer_treeview_calibrations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#creer_treeview_calibrations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="creer_treeview_calibrations-584"><a href="#creer_treeview_calibrations-584"><span class="linenos">584</span></a><span class="k">def</span> <span class="nf">creer_treeview_calibrations</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
</span><span id="creer_treeview_calibrations-585"><a href="#creer_treeview_calibrations-585"><span class="linenos">585</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée et configure le TreeView des calibrations avec sélection multiple.&quot;&quot;&quot;</span>
</span><span id="creer_treeview_calibrations-586"><a href="#creer_treeview_calibrations-586"><span class="linenos">586</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-587"><a href="#creer_treeview_calibrations-587"><span class="linenos">587</span></a>
</span><span id="creer_treeview_calibrations-588"><a href="#creer_treeview_calibrations-588"><span class="linenos">588</span></a>    <span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;date_test&quot;</span><span class="p">,</span> <span class="s2">&quot;version_logiciel&quot;</span><span class="p">,</span> <span class="s2">&quot;nom_capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;operateur&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-589"><a href="#creer_treeview_calibrations-589"><span class="linenos">589</span></a>               <span class="s2">&quot;fichier_source&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_conversion_a&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_conversion_b&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-590"><a href="#creer_treeview_calibrations-590"><span class="linenos">590</span></a>               <span class="s2">&quot;coef_capteur_a&quot;</span><span class="p">,</span> <span class="s2">&quot;coef_capteur_b&quot;</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-591"><a href="#creer_treeview_calibrations-591"><span class="linenos">591</span></a>
</span><span id="creer_treeview_calibrations-592"><a href="#creer_treeview_calibrations-592"><span class="linenos">592</span></a>    <span class="c1"># Ajouter le paramètre selectmode=&#39;extended&#39; pour permettre la sélection multiple</span>
</span><span id="creer_treeview_calibrations-593"><a href="#creer_treeview_calibrations-593"><span class="linenos">593</span></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s2">&quot;headings&quot;</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="s1">&#39;extended&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-594"><a href="#creer_treeview_calibrations-594"><span class="linenos">594</span></a>
</span><span id="creer_treeview_calibrations-595"><a href="#creer_treeview_calibrations-595"><span class="linenos">595</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="creer_treeview_calibrations-596"><a href="#creer_treeview_calibrations-596"><span class="linenos">596</span></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-597"><a href="#creer_treeview_calibrations-597"><span class="linenos">597</span></a>        <span class="s2">&quot;date_test&quot;</span><span class="p">:</span> <span class="s2">&quot;Date Test&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-598"><a href="#creer_treeview_calibrations-598"><span class="linenos">598</span></a>        <span class="s2">&quot;version_logiciel&quot;</span><span class="p">:</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-599"><a href="#creer_treeview_calibrations-599"><span class="linenos">599</span></a>        <span class="s2">&quot;nom_capteur&quot;</span><span class="p">:</span> <span class="s2">&quot;Capteur&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-600"><a href="#creer_treeview_calibrations-600"><span class="linenos">600</span></a>        <span class="s2">&quot;operateur&quot;</span><span class="p">:</span> <span class="s2">&quot;Opérateur&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-601"><a href="#creer_treeview_calibrations-601"><span class="linenos">601</span></a>        <span class="s2">&quot;fichier_source&quot;</span><span class="p">:</span> <span class="s2">&quot;Fichier&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-602"><a href="#creer_treeview_calibrations-602"><span class="linenos">602</span></a>        <span class="s2">&quot;coef_conversion_a&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Conv A&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-603"><a href="#creer_treeview_calibrations-603"><span class="linenos">603</span></a>        <span class="s2">&quot;coef_conversion_b&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Conv B&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-604"><a href="#creer_treeview_calibrations-604"><span class="linenos">604</span></a>        <span class="s2">&quot;coef_capteur_a&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Capt A&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_calibrations-605"><a href="#creer_treeview_calibrations-605"><span class="linenos">605</span></a>        <span class="s2">&quot;coef_capteur_b&quot;</span><span class="p">:</span> <span class="s2">&quot;Coef Capt B&quot;</span>
</span><span id="creer_treeview_calibrations-606"><a href="#creer_treeview_calibrations-606"><span class="linenos">606</span></a>    <span class="p">}</span>
</span><span id="creer_treeview_calibrations-607"><a href="#creer_treeview_calibrations-607"><span class="linenos">607</span></a>
</span><span id="creer_treeview_calibrations-608"><a href="#creer_treeview_calibrations-608"><span class="linenos">608</span></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="creer_treeview_calibrations-609"><a href="#creer_treeview_calibrations-609"><span class="linenos">609</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
</span><span id="creer_treeview_calibrations-610"><a href="#creer_treeview_calibrations-610"><span class="linenos">610</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-611"><a href="#creer_treeview_calibrations-611"><span class="linenos">611</span></a>
</span><span id="creer_treeview_calibrations-612"><a href="#creer_treeview_calibrations-612"><span class="linenos">612</span></a>    <span class="c1"># Scrollbars</span>
</span><span id="creer_treeview_calibrations-613"><a href="#creer_treeview_calibrations-613"><span class="linenos">613</span></a>    <span class="n">vsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-614"><a href="#creer_treeview_calibrations-614"><span class="linenos">614</span></a>    <span class="n">hsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">xview</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-615"><a href="#creer_treeview_calibrations-615"><span class="linenos">615</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">vsb</span><span class="o">.</span><span class="n">set</span><span class="p">,</span> <span class="n">xscrollcommand</span><span class="o">=</span><span class="n">hsb</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-616"><a href="#creer_treeview_calibrations-616"><span class="linenos">616</span></a>
</span><span id="creer_treeview_calibrations-617"><a href="#creer_treeview_calibrations-617"><span class="linenos">617</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-618"><a href="#creer_treeview_calibrations-618"><span class="linenos">618</span></a>    <span class="n">vsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-619"><a href="#creer_treeview_calibrations-619"><span class="linenos">619</span></a>    <span class="n">hsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-620"><a href="#creer_treeview_calibrations-620"><span class="linenos">620</span></a>
</span><span id="creer_treeview_calibrations-621"><a href="#creer_treeview_calibrations-621"><span class="linenos">621</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-622"><a href="#creer_treeview_calibrations-622"><span class="linenos">622</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="creer_treeview_calibrations-623"><a href="#creer_treeview_calibrations-623"><span class="linenos">623</span></a>
</span><span id="creer_treeview_calibrations-624"><a href="#creer_treeview_calibrations-624"><span class="linenos">624</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
</span><span id="creer_treeview_calibrations-625"><a href="#creer_treeview_calibrations-625"><span class="linenos">625</span></a>    <span class="k">return</span> <span class="n">tree</span>
</span></pre></div>


            <div class="docstring"><p>Crée et configure le TreeView des calibrations avec sélection multiple.</p>
</div>


                </section>
                <section id="creer_treeview_paliers">
                            <input id="creer_treeview_paliers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">creer_treeview_paliers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="creer_treeview_paliers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#creer_treeview_paliers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="creer_treeview_paliers-627"><a href="#creer_treeview_paliers-627"><span class="linenos">627</span></a><span class="k">def</span> <span class="nf">creer_treeview_paliers</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
</span><span id="creer_treeview_paliers-628"><a href="#creer_treeview_paliers-628"><span class="linenos">628</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée et configure le TreeView des paliers.&quot;&quot;&quot;</span>
</span><span id="creer_treeview_paliers-629"><a href="#creer_treeview_paliers-629"><span class="linenos">629</span></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-630"><a href="#creer_treeview_paliers-630"><span class="linenos">630</span></a>
</span><span id="creer_treeview_paliers-631"><a href="#creer_treeview_paliers-631"><span class="linenos">631</span></a>    <span class="c1"># Définition des colonnes</span>
</span><span id="creer_treeview_paliers-632"><a href="#creer_treeview_paliers-632"><span class="linenos">632</span></a>    <span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;calibration_id&quot;</span><span class="p">,</span> <span class="s2">&quot;numero_palier&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;nb_valeurs&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-633"><a href="#creer_treeview_paliers-633"><span class="linenos">633</span></a>               <span class="s2">&quot;moyenne_c_rac&quot;</span><span class="p">,</span> <span class="s2">&quot;ecart_type_c_rac&quot;</span><span class="p">,</span> <span class="s2">&quot;moyenne_c_ref&quot;</span><span class="p">,</span> <span class="s2">&quot;ecart_type_c_ref&quot;</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-634"><a href="#creer_treeview_paliers-634"><span class="linenos">634</span></a>
</span><span id="creer_treeview_paliers-635"><a href="#creer_treeview_paliers-635"><span class="linenos">635</span></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s2">&quot;headings&quot;</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-636"><a href="#creer_treeview_paliers-636"><span class="linenos">636</span></a>
</span><span id="creer_treeview_paliers-637"><a href="#creer_treeview_paliers-637"><span class="linenos">637</span></a>    <span class="c1"># Configuration des en-têtes</span>
</span><span id="creer_treeview_paliers-638"><a href="#creer_treeview_paliers-638"><span class="linenos">638</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="creer_treeview_paliers-639"><a href="#creer_treeview_paliers-639"><span class="linenos">639</span></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-640"><a href="#creer_treeview_paliers-640"><span class="linenos">640</span></a>        <span class="s2">&quot;calibration_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Cal ID&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-641"><a href="#creer_treeview_paliers-641"><span class="linenos">641</span></a>        <span class="s2">&quot;numero_palier&quot;</span><span class="p">:</span> <span class="s2">&quot;N° Palier&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-642"><a href="#creer_treeview_paliers-642"><span class="linenos">642</span></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-643"><a href="#creer_treeview_paliers-643"><span class="linenos">643</span></a>        <span class="s2">&quot;nb_valeurs&quot;</span><span class="p">:</span> <span class="s2">&quot;Nb Valeurs&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-644"><a href="#creer_treeview_paliers-644"><span class="linenos">644</span></a>        <span class="s2">&quot;moyenne_c_rac&quot;</span><span class="p">:</span> <span class="s2">&quot;Moy C_rac&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-645"><a href="#creer_treeview_paliers-645"><span class="linenos">645</span></a>        <span class="s2">&quot;ecart_type_c_rac&quot;</span><span class="p">:</span> <span class="s2">&quot;ET C_rac&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-646"><a href="#creer_treeview_paliers-646"><span class="linenos">646</span></a>        <span class="s2">&quot;moyenne_c_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;Moy C_ref&quot;</span><span class="p">,</span>
</span><span id="creer_treeview_paliers-647"><a href="#creer_treeview_paliers-647"><span class="linenos">647</span></a>        <span class="s2">&quot;ecart_type_c_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;ET C_ref&quot;</span>
</span><span id="creer_treeview_paliers-648"><a href="#creer_treeview_paliers-648"><span class="linenos">648</span></a>    <span class="p">}</span>
</span><span id="creer_treeview_paliers-649"><a href="#creer_treeview_paliers-649"><span class="linenos">649</span></a>
</span><span id="creer_treeview_paliers-650"><a href="#creer_treeview_paliers-650"><span class="linenos">650</span></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="creer_treeview_paliers-651"><a href="#creer_treeview_paliers-651"><span class="linenos">651</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
</span><span id="creer_treeview_paliers-652"><a href="#creer_treeview_paliers-652"><span class="linenos">652</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-653"><a href="#creer_treeview_paliers-653"><span class="linenos">653</span></a>
</span><span id="creer_treeview_paliers-654"><a href="#creer_treeview_paliers-654"><span class="linenos">654</span></a>    <span class="c1"># Scrollbars</span>
</span><span id="creer_treeview_paliers-655"><a href="#creer_treeview_paliers-655"><span class="linenos">655</span></a>    <span class="n">vsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-656"><a href="#creer_treeview_paliers-656"><span class="linenos">656</span></a>    <span class="n">hsb</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">xview</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-657"><a href="#creer_treeview_paliers-657"><span class="linenos">657</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">vsb</span><span class="o">.</span><span class="n">set</span><span class="p">,</span> <span class="n">xscrollcommand</span><span class="o">=</span><span class="n">hsb</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-658"><a href="#creer_treeview_paliers-658"><span class="linenos">658</span></a>
</span><span id="creer_treeview_paliers-659"><a href="#creer_treeview_paliers-659"><span class="linenos">659</span></a>    <span class="c1"># Placement des widgets</span>
</span><span id="creer_treeview_paliers-660"><a href="#creer_treeview_paliers-660"><span class="linenos">660</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-661"><a href="#creer_treeview_paliers-661"><span class="linenos">661</span></a>    <span class="n">vsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-662"><a href="#creer_treeview_paliers-662"><span class="linenos">662</span></a>    <span class="n">hsb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-663"><a href="#creer_treeview_paliers-663"><span class="linenos">663</span></a>
</span><span id="creer_treeview_paliers-664"><a href="#creer_treeview_paliers-664"><span class="linenos">664</span></a>    <span class="c1"># Configuration du redimensionnement</span>
</span><span id="creer_treeview_paliers-665"><a href="#creer_treeview_paliers-665"><span class="linenos">665</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-666"><a href="#creer_treeview_paliers-666"><span class="linenos">666</span></a>    <span class="n">frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="creer_treeview_paliers-667"><a href="#creer_treeview_paliers-667"><span class="linenos">667</span></a>
</span><span id="creer_treeview_paliers-668"><a href="#creer_treeview_paliers-668"><span class="linenos">668</span></a>    <span class="n">tree</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>  <span class="c1"># Permet d&#39;accéder au frame depuis l&#39;extérieur</span>
</span><span id="creer_treeview_paliers-669"><a href="#creer_treeview_paliers-669"><span class="linenos">669</span></a>    <span class="k">return</span> <span class="n">tree</span>
</span></pre></div>


            <div class="docstring"><p>Crée et configure le TreeView des paliers.</p>
</div>


                </section>
                <section id="exporter_donnees_filtrees">
                            <input id="exporter_donnees_filtrees-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exporter_donnees_filtrees</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filtres</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="exporter_donnees_filtrees-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#exporter_donnees_filtrees"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="exporter_donnees_filtrees-671"><a href="#exporter_donnees_filtrees-671"><span class="linenos">671</span></a><span class="k">def</span> <span class="nf">exporter_donnees_filtrees</span><span class="p">(</span><span class="n">filtres</span><span class="p">):</span>
</span><span id="exporter_donnees_filtrees-672"><a href="#exporter_donnees_filtrees-672"><span class="linenos">672</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exporte les données filtrées vers Excel.&quot;&quot;&quot;</span>
</span><span id="exporter_donnees_filtrees-673"><a href="#exporter_donnees_filtrees-673"><span class="linenos">673</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="exporter_donnees_filtrees-674"><a href="#exporter_donnees_filtrees-674"><span class="linenos">674</span></a>    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="exporter_donnees_filtrees-675"><a href="#exporter_donnees_filtrees-675"><span class="linenos">675</span></a>
</span><span id="exporter_donnees_filtrees-676"><a href="#exporter_donnees_filtrees-676"><span class="linenos">676</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="exporter_donnees_filtrees-677"><a href="#exporter_donnees_filtrees-677"><span class="linenos">677</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;nom_capteur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;capteur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="exporter_donnees_filtrees-678"><a href="#exporter_donnees_filtrees-678"><span class="linenos">678</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="exporter_donnees_filtrees-679"><a href="#exporter_donnees_filtrees-679"><span class="linenos">679</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;strftime(&quot;%Y&quot;, date_test)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;annee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="exporter_donnees_filtrees-680"><a href="#exporter_donnees_filtrees-680"><span class="linenos">680</span></a>    <span class="k">if</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="exporter_donnees_filtrees-681"><a href="#exporter_donnees_filtrees-681"><span class="linenos">681</span></a>        <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtres</span><span class="p">[</span><span class="s1">&#39;operateur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="exporter_donnees_filtrees-682"><a href="#exporter_donnees_filtrees-682"><span class="linenos">682</span></a>
</span><span id="exporter_donnees_filtrees-683"><a href="#exporter_donnees_filtrees-683"><span class="linenos">683</span></a>    <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">exporter_excel</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
</span><span id="exporter_donnees_filtrees-684"><a href="#exporter_donnees_filtrees-684"><span class="linenos">684</span></a>    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="exporter_donnees_filtrees-685"><a href="#exporter_donnees_filtrees-685"><span class="linenos">685</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Export réussi&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="exporter_donnees_filtrees-686"><a href="#exporter_donnees_filtrees-686"><span class="linenos">686</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="exporter_donnees_filtrees-687"><a href="#exporter_donnees_filtrees-687"><span class="linenos">687</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="exporter_donnees_filtrees-688"><a href="#exporter_donnees_filtrees-688"><span class="linenos">688</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Exporte les données filtrées vers Excel.</p>
</div>


                </section>
                <section id="exporter_dernieres_calibrations_db">
                            <input id="exporter_dernieres_calibrations_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exporter_dernieres_calibrations_db</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="exporter_dernieres_calibrations_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#exporter_dernieres_calibrations_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="exporter_dernieres_calibrations_db-690"><a href="#exporter_dernieres_calibrations_db-690"><span class="linenos">690</span></a><span class="k">def</span> <span class="nf">exporter_dernieres_calibrations_db</span><span class="p">():</span>
</span><span id="exporter_dernieres_calibrations_db-691"><a href="#exporter_dernieres_calibrations_db-691"><span class="linenos">691</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Appelle directement la méthode de DBManager pour exporter les dernières calibrations.&quot;&quot;&quot;</span>
</span><span id="exporter_dernieres_calibrations_db-692"><a href="#exporter_dernieres_calibrations_db-692"><span class="linenos">692</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">DBManager</span><span class="p">()</span>
</span><span id="exporter_dernieres_calibrations_db-693"><a href="#exporter_dernieres_calibrations_db-693"><span class="linenos">693</span></a>    <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">exporter_dernieres_calibrations</span><span class="p">()</span>
</span><span id="exporter_dernieres_calibrations_db-694"><a href="#exporter_dernieres_calibrations_db-694"><span class="linenos">694</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span id="exporter_dernieres_calibrations_db-695"><a href="#exporter_dernieres_calibrations_db-695"><span class="linenos">695</span></a>
</span><span id="exporter_dernieres_calibrations_db-696"><a href="#exporter_dernieres_calibrations_db-696"><span class="linenos">696</span></a>    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="exporter_dernieres_calibrations_db-697"><a href="#exporter_dernieres_calibrations_db-697"><span class="linenos">697</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Export réussi&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span id="exporter_dernieres_calibrations_db-698"><a href="#exporter_dernieres_calibrations_db-698"><span class="linenos">698</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="exporter_dernieres_calibrations_db-699"><a href="#exporter_dernieres_calibrations_db-699"><span class="linenos">699</span></a>        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Appelle directement la méthode de DBManager pour exporter les dernières calibrations.</p>
</div>


                </section>
                <section id="Nan">
                            <input id="Nan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Nan</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Nan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Nan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Nan-701"><a href="#Nan-701"><span class="linenos">701</span></a><span class="k">def</span> <span class="nf">Nan</span><span class="p">():</span>
</span><span id="Nan-702"><a href="#Nan-702"><span class="linenos">702</span></a>    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Le gars il a dit non :p, mais mais mais&quot;</span>
</span><span id="Nan-703"><a href="#Nan-703"><span class="linenos">703</span></a>    <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="creer_affichage">
                            <input id="creer_affichage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">creer_affichage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">root</span><span class="p">:</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="creer_affichage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#creer_affichage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="creer_affichage-705"><a href="#creer_affichage-705"><span class="linenos">705</span></a><span class="k">def</span> <span class="nf">creer_affichage</span><span class="p">(</span><span class="n">root</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
</span><span id="creer_affichage-706"><a href="#creer_affichage-706"><span class="linenos">706</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Crée l&#39;interface graphique principale et gère la taille de la fenêtre.&quot;&quot;&quot;</span>
</span><span id="creer_affichage-707"><a href="#creer_affichage-707"><span class="linenos">707</span></a>
</span><span id="creer_affichage-708"><a href="#creer_affichage-708"><span class="linenos">708</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span> <span class="c1"># Important pour obtenir les dimensions correctes</span>
</span><span id="creer_affichage-709"><a href="#creer_affichage-709"><span class="linenos">709</span></a>    <span class="n">screen_width</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
</span><span id="creer_affichage-710"><a href="#creer_affichage-710"><span class="linenos">710</span></a>    <span class="n">screen_height</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
</span><span id="creer_affichage-711"><a href="#creer_affichage-711"><span class="linenos">711</span></a>
</span><span id="creer_affichage-712"><a href="#creer_affichage-712"><span class="linenos">712</span></a>    <span class="c1"># Définir une taille maximale pour la fenêtre (par exemple, 80% de l&#39;écran)</span>
</span><span id="creer_affichage-713"><a href="#creer_affichage-713"><span class="linenos">713</span></a>    <span class="n">max_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">screen_width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="creer_affichage-714"><a href="#creer_affichage-714"><span class="linenos">714</span></a>    <span class="n">max_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">screen_height</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="creer_affichage-715"><a href="#creer_affichage-715"><span class="linenos">715</span></a>
</span><span id="creer_affichage-716"><a href="#creer_affichage-716"><span class="linenos">716</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">max_height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Définir la taille maximale</span>
</span><span id="creer_affichage-717"><a href="#creer_affichage-717"><span class="linenos">717</span></a>
</span><span id="creer_affichage-718"><a href="#creer_affichage-718"><span class="linenos">718</span></a>    <span class="n">notebook</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="creer_affichage-719"><a href="#creer_affichage-719"><span class="linenos">719</span></a>    <span class="n">notebook</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="creer_affichage-720"><a href="#creer_affichage-720"><span class="linenos">720</span></a>
</span><span id="creer_affichage-721"><a href="#creer_affichage-721"><span class="linenos">721</span></a>    <span class="n">creer_onglet_base_de_donnees</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span><span id="creer_affichage-722"><a href="#creer_affichage-722"><span class="linenos">722</span></a>    <span class="n">creer_onglet_deux</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Crée l'interface graphique principale et gère la taille de la fenêtre.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>